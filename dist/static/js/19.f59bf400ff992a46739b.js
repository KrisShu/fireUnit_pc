webpackJsonp([19],{GwnM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("BO1k"),n=a.n(l),i=a("Nn1j"),r=a("HR9O"),s={components:{baseTable:i.a,baseDialog:r.a},data:function(){return{screensign:"全部",buttonarr:[{type:"primary",text:"全部"},{type:"warning",text:"未处理",num:0},{type:"success",text:"已处理",num:0}],tableThead:[{name:"报警时间",prop:"creationTime"},{name:"设备地址",prop:"deviceAddress"},{name:"监控类型",prop:"monitorType"},{name:"安装位置",prop:"location"},{name:"报警数值",prop:"value"},{name:"处理",prop:"alarmHandleStatus"}],tableData:[],totalCount:0,page:{FireUnitId:localStorage.getItem("fireUnitID"),VisitSource:1,SkipCount:0,MaxResultCount:10},form:{CheckState:4,CheckContent:""},alarmDataId:"",alarmHandleStatus:"",details:{}}},created:function(){this.GetWaterAlarmList(),this.GetWaterAlarmCheckStatusNum()},methods:{GetWaterAlarmCheckStatusNum:function(){var t=this;this.$axios.get(this.$api.GetWaterAlarmCheckStatusNum,{params:{fireUnitId:localStorage.getItem("fireUnitID")}}).then(function(e){t.buttonarr[1].num=e.data.result[0].value,t.buttonarr[2].num=e.data.result[1].value})},screen:function(t){this.screensign=t,"未处理"==t?this.page.HandleStatusFilter=3:"已处理"==t?this.page.HandleStatusFilter=2:"全部"==t&&(this.page.HandleStatusFilter=1),this.page.SkipCount=0,this.GetWaterAlarmList()},GetWaterAlarmList:function(){var t=this;this.$axios.get(this.$api.GetWaterAlarmList,{params:this.page}).then(function(e){console.log("获取消防管网",e);var a=!0,l=!1,i=void 0;try{for(var r,s=n()(e.data.result.items);!(a=(r=s.next()).done);a=!0){var o=r.value;o.creationTime=t.delTime(o.creationTime)}}catch(t){l=!0,i=t}finally{try{!a&&s.return&&s.return()}finally{if(l)throw i}}var c=e.data.result;t.totalCount=c.totalCount,t.tableData=c.items}).catch(function(t){console.log("获取消防管网失败",t)})},delTime:function(t){var e=t.split("T"),a=e[1].split(".");return e[0]+" "+a[0]},prev_next:function(t){this.page.SkipCount=(t-1)*this.page.MaxResultCount,this.GetWaterAlarmList()},dealDetail:function(t){console.log("dealDetail",t),this.$refs.baseDialog.dialogVisible=!0,this.alarmDataId=t.alarmDataId,this.alarmHandleStatus=t.alarmHandleStatus,1!=t.alarmHandleStatus&&this.GetWaterAlarmCheckDetail(t.alarmDataId)},GetWaterAlarmCheckDetail:function(t){var e=this;this.$axios.get(this.$api.GetWaterAlarmCheckDetail,{params:{alarmId:t}}).then(function(t){if(console.log("详情",t),t.data.result.handleTime&&(t.data.result.handleTime=e.delTime(t.data.result.handleTime)),t.data.result.handleVoiceUrl){t.data.result.handleVoiceUrl=""+e.$URL+t.data.result.handleVoiceUrl;var l=a("/y4m");e.amr=new l,e.amr.initWithUrl(t.data.result.handleVoiceUrl)}e.details=t.data.result})},playVioce:function(){this.amr.play(),this.amr.onEnded(function(){console.log("播放完毕")})},submit:function(){var t=this,e=new FormData;e.append("CheckState",this.form.CheckState),e.append("CheckUserId ",localStorage.getItem("userId")),e.append("AlarmDataId",this.alarmDataId),e.append("CheckContent",this.form.CheckContent),this.$axios.post(this.$api.CheckWaterAlarm,e).then(function(e){console.log("请求",e),e.data.success&&(t.form.CheckState=4,t.form.CheckContent="",t.$refs.baseDialog.dialogVisible=!1,t.GetWaterAlarmList(),t.GetWaterAlarmCheckStatusNum())})}}},o={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"hiddenPipe"},[l("div",{staticClass:"topStatus"},t._l(t.buttonarr,function(e){return l("el-button",{key:e.text,attrs:{round:"",plain:"",type:e.type},on:{click:function(a){return t.screen(e.text)}}},[t.screensign==e.text?l("i",{staticClass:"el-icon-check  el-icon--right"}):t._e(),t._v("\n              "+t._s(e.text)+" "+t._s(e.num)+"\n          ")])}),1),t._v(" "),l("baseTable",{attrs:{tableThead:t.tableThead,tableData:t.tableData,totalCount:t.totalCount,pageSize:10},on:{pageChange:t.prev_next,dealDetail:t.dealDetail}}),t._v(" "),l("baseDialog",{ref:"baseDialog",attrs:{title:"警情处理",width:"40%"}},[1==t.alarmHandleStatus?l("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"情况处理："}},[l("el-radio-group",{model:{value:t.form.CheckState,callback:function(e){t.$set(t.form,"CheckState",e)},expression:"form.CheckState"}},[l("el-radio",{attrs:{label:4}},[t._v("忽略")]),t._v(" "),l("el-radio",{attrs:{label:2}},[t._v("误报")]),t._v(" "),l("el-radio",{attrs:{label:3}},[t._v("已处理")])],1)],1),t._v(" "),l("el-form-item",{attrs:{label:"情况描述："}},[l("el-input",{attrs:{type:"textarea",placeholder:"情况简要描述，200字以内",rows:"10"},model:{value:t.form.CheckContent,callback:function(e){t.$set(t.form,"CheckContent",e)},expression:"form.CheckContent"}})],1),t._v(" "),l("el-button",{on:{click:t.submit}},[t._v("提交")])],1):l("div",{staticClass:"detailsBox"},[l("p",[t._v("处理时间："),l("span",[t._v(t._s(t.details.handleTime))])]),t._v(" "),l("p",[t._v("处理状态：\n              "),2==t.details.alarmHandleStatus?l("span",[t._v("误报")]):t._e(),t._v(" "),3==t.details.alarmHandleStatus?l("span",[t._v("已处理")]):t._e(),t._v(" "),4==t.details.alarmHandleStatus?l("span",[t._v("忽略")]):t._e()]),t._v(" "),l("div",[t.details.handleContent?l("p",{staticClass:"handleContent"},[t._v("情况描述："),l("span",[t._v(t._s(t.details.handleContent))])]):t._e(),t._v(" "),t.details.handleVoiceUrl?l("div",{staticClass:"display_p"},[l("span",[t._v(" 情况描述：")]),t._v(" "),l("div",{staticClass:"vioceUrl",on:{click:function(e){return t.playVioce(t.details.handleVoiceUrl)}}},[l("img",{attrs:{src:a("FEo8"),alt:""}}),t._v(" "),l("span",[t._v(t._s(t.details.handleVoiceLength)+'"')])])]):t._e()])])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(s,o,!1,function(t){a("iy0X")},null,null);e.default=c.exports},iy0X:function(t,e){}});
//# sourceMappingURL=19.f59bf400ff992a46739b.js.map