webpackJsonp([5],{"1alW":function(e,t,r){var a=r("kM2E");a(a.S,"Number",{isInteger:r("AKgy")})},AKgy:function(e,t,r){var a=r("EqjI"),i=Math.floor;e.exports=function(e){return!a(e)&&isFinite(e)&&i(e)===e}},OMJi:function(e,t,r){(function(e){var a=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},a=0;a<t.length;a++)r[t[a]]=Object.getOwnPropertyDescriptor(e,t[a]);return r},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(l(arguments[r]));return t.join(" ")}r=1;for(var a=arguments,o=a.length,n=String(e).replace(i,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(a[r++]);case"%d":return Number(a[r++]);case"%j":try{return JSON.stringify(a[r++])}catch(e){return"[Circular]"}default:return e}}),s=a[r];r<o;s=a[++r])h(s)||!_(s)?n+=" "+s:n+=" "+l(s);return n},t.deprecate=function(r,a){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,a).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(a);e.traceDeprecation?console.trace(a):console.error(a),i=!0}return r.apply(this,arguments)}};var o,n={};function l(e,r){var a={seen:[],stylize:c};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),d(r)?a.showHidden=r:r&&t._extend(a,r),b(a.showHidden)&&(a.showHidden=!1),b(a.depth)&&(a.depth=2),b(a.colors)&&(a.colors=!1),b(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=s),u(a,e,a.depth)}function s(e,t){var r=l.styles[t];return r?"["+l.colors[r][0]+"m"+e+"["+l.colors[r][1]+"m":e}function c(e,t){return e}function u(e,r,a){if(e.customInspect&&r&&w(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(a,e);return v(i)||(i=u(e,i,a)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(h(t))return e.stylize("null","null")}(e,r);if(o)return o;var n=Object.keys(r),l=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(n);if(e.showHidden&&(n=Object.getOwnPropertyNames(r)),k(r)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return m(r);if(0===n.length){if(w(r)){var s=r.name?": "+r.name:"";return e.stylize("[Function"+s+"]","special")}if(y(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(D(r))return e.stylize(Date.prototype.toString.call(r),"date");if(k(r))return m(r)}var c,_="",A=!1,x=["{","}"];(f(r)&&(A=!0,x=["[","]"]),w(r))&&(_=" [Function"+(r.name?": "+r.name:"")+"]");return y(r)&&(_=" "+RegExp.prototype.toString.call(r)),D(r)&&(_=" "+Date.prototype.toUTCString.call(r)),k(r)&&(_=" "+m(r)),0!==n.length||A&&0!=r.length?a<0?y(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=A?function(e,t,r,a,i){for(var o=[],n=0,l=t.length;n<l;++n)C(t,String(n))?o.push(p(e,t,r,a,String(n),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,r,a,i,!0))}),o}(e,r,a,l,n):n.map(function(t){return p(e,r,a,l,t,A)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,_,x)):x[0]+_+x[1]}function m(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,a,i,o){var n,l,s;if((s=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?l=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(l=e.stylize("[Setter]","special")),C(a,i)||(n="["+i+"]"),l||(e.seen.indexOf(s.value)<0?(l=h(r)?u(e,s.value,null):u(e,s.value,r-1)).indexOf("\n")>-1&&(l=o?l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+l.split("\n").map(function(e){return"   "+e}).join("\n")):l=e.stylize("[Circular]","special")),b(n)){if(o&&i.match(/^\d+$/))return l;(n=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+l}function f(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function h(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function b(e){return void 0===e}function y(e){return _(e)&&"[object RegExp]"===A(e)}function _(e){return"object"==typeof e&&null!==e}function D(e){return _(e)&&"[object Date]"===A(e)}function k(e){return _(e)&&("[object Error]"===A(e)||e instanceof Error)}function w(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(b(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),r=r.toUpperCase(),!n[r])if(new RegExp("\\b"+r+"\\b","i").test(o)){var a=e.pid;n[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,a,e)}}else n[r]=function(){};return n[r]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=d,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=y,t.isObject=_,t.isDate=D,t.isError=k,t.isFunction=w,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r("fC4T");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,r;console.log("%s - %s",(e=new Date,r=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":"),[e.getDate(),F[e.getMonth()],r].join(" ")),t.format.apply(t,arguments))},t.inherits=r("ONRY"),t._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),a=r.length;a--;)e[r[a]]=t[r[a]];return e};var $="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function S(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if($&&e[$]){var t;if("function"!=typeof(t=e[$]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,a=new Promise(function(e,a){t=e,r=a}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(e,a){e?r(e):t(a)});try{e.apply(this,i)}catch(e){r(e)}return a}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),$&&Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,a(e))},t.promisify.custom=$,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],a=0;a<arguments.length;a++)r.push(arguments[a]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,n=function(){return i.apply(o,arguments)};t.apply(this,r).then(function(t){e.nextTick(n,null,t)},function(t){e.nextTick(S,t,n)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,a(t)),r}}).call(t,r("W2nU"))},ONRY:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},"RRo+":function(e,t,r){e.exports={default:r("c45H"),__esModule:!0}},UGPn:function(e,t){},YSze:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),i=r.n(a),o=r("BO1k"),n=r.n(o),l=r("RRo+"),s=r.n(l),c=r("Nn1j"),u=r("HR9O"),m=(r("OMJi"),{components:{baseTable:c.a,baseDialog:u.a},data:function(){return{firenetworkState:{online:0,offline:0},screensign:"全部",page:{FireUnitId:localStorage.getItem("fireUnitID"),SkipCount:0,MaxResultCount:10},totalCount:0,buildList:[],DeviceTypes:[],DeviceProtocols:[],Baudrates:["1200","2400","4800","9600","14400","19200","28800","38400","57600","115200"],types:["232","485"],tableThead:[{name:"设备编号",prop:"deviceSn"},{name:"所在建筑",prop:"fireUnitArchitectureName"},{name:"状态",prop:"state"},{name:"联网部件数量",prop:"netDetectorNum"},{name:"故障部件数量",prop:"faultDetectorNum"},{name:"部件故障率",prop:"detectorFaultRate"},{name:"30天火警数量",prop:"alarmNum30Day"},{name:"高频部件数量",prop:"highAlarmDetectorNum"},{name:"操作",width:"200px"}],tableData:[],equmentform:{enableAlarm:[],enableFault:[]},equmentform1:{deviceModel:"TSJ-CS10",enableAlarm:["云端报警"],enableFault:["云端报警"],baudRate:"9600",comType:"232"},rules:{deviceModel:[{required:!0,message:"选择设备型号",trigger:"change"}],deviceSn:[{required:!0,message:"请填写设备编号",trigger:"blur"}],netDetectorNum:[{validator:function(e,t,r){setTimeout(function(){s()(t)?r():r(new Error("请输入数字值"))},1e3)},trigger:"blur"}]},PortParam:{},networkFormrules:{identify:[{required:!0,message:"请填写部件地址",trigger:"blur"}]},networkThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"安装位置",prop:"location"},{name:"状态",prop:"state"},{name:"操作"}],networkData:[],networkForm:{},FireAlarmDetectorTypes:[],fireUnitArchitecturefloors:[],networktotalCount:0,networkPage:{SkipCount:0,MaxResultCount:5,current:1},fileList:[],FaultPage:{SkipCount:0,MaxResultCount:5,current:1},faultTotalCount:0,faultThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"故障描述",prop:"faultContent"},{name:"故障时间",prop:"faultTime"}],faultData:[],alarm30_high_title:"火警联网系统30天火警记录",Alarm30Day_highPage:{SkipCount:0,MaxResultCount:5,current:1},Alarm30Day_highTotal:0,Alarm30Day_highThead:[],Alarm30Day_highData:[],Alarm30Day_toptips_fireUnitArchitectureName:"",Alarm30Day_toptips_deviceSn:"",highThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"平均每天报警",prop:"alarmNum"}],Alarm30DayThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"报警时间",prop:"alarmTime"}],loading:!1}},created:function(){this.GetFireAlarmDeviceStateNum(),this.GetListByFireUnitId(),this.GetFireAlarmDeviceList(),this.GetFireAlarmDeviceModels()},methods:{GetFireAlarmDeviceStateNum:function(){var e=this;this.$axios.get(this.$api.GetFireAlarmDeviceStateNum,{params:this.page}).then(function(t){console.log("res状态数量",t),e.firenetworkState.online=t.data.result[0].value,e.firenetworkState.offline=t.data.result[1].value})},screen:function(e){this.screensign=e,this.page.DeviceState=e,this.GetFireAlarmDeviceList()},GetFireAlarmDeviceList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmDeviceList,{params:this.page}).then(function(t){console.log("GetFireAlarmDeviceList",t),e.loading=!1;var r=t.data.result;e.tableData=r.items,e.totalCount=r.totalCount,0==t.data.result.items.length&&t.data.result.totalCount>0&&(e.page.SkipCount=0,e.GetFireAlarmDeviceList())}).catch(function(e){console.log("err",e)})},AlarmDeviceList_prev_next:function(e){this.page.SkipCount=(e-1)*this.page.MaxResultCount,this.GetFireAlarmDeviceList()},GetListByFireUnitId:function(){var e=this,t=localStorage.getItem("fireUnitID");this.$axios.get(this.$api.GetListByFireUnitId,{params:{fireunitId:t}}).then(function(t){if(console.log("获取到的建筑",t),t.data.result.length>0){var r=[],a=!0,i=!1,o=void 0;try{for(var l,s=n()(t.data.result);!(a=(l=s.next()).done);a=!0){var c=l.value;r.push({name:c.name,id:c.id})}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}console.log("arrlist",r),e.buildList=r}}).catch(function(e){console.log("获取到的建筑error",e)})},GetFireAlarmDeviceModels:function(){var e=this;this.$axios.all([this.$axios.get(this.$api.GetFireAlarmDeviceModels,{params:{}}),this.$axios.get(this.$api.GetFireAlarmDeviceProtocols,{params:{}})]).then(this.$axios.spread(function(t,r){console.log("data1",t),console.log("data2",r),t.data.result.length>0&&(e.DeviceTypes=t.data.result),r.data.result.length>0&&(e.DeviceProtocols=r.data.result)})).catch(this.$axios.spread(function(e,t){console.log("data1",e),console.log("data2",t)}))},add_update_equment:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.equmentform.fireUnitId=localStorage.getItem("fireUnitID"),console.log("this.equmentform",e.equmentform),(e.equmentform.deviceId?e.$axios.put(e.$api.UpdateFireAlarmDevice,e.equmentform):e.$axios.post(e.$api.AddFireAlarmDevice,e.equmentform)).then(function(t){console.log("新增设施成功",t),t.data.success&&(e.$message.success((e.equmentform.deviceId?"修改":"新增")+"联网设施成功"),e.$refs.baseDialog.dialogVisible=!1,e.GetFireAlarmDeviceList())}).catch(function(e){console.log("新增或修改联网设施失败",e)}))})},cancel:function(e){if(e)this.$refs.baseDialog.dialogVisible=!1;else{var t=i()(this.equmentform1);this.equmentform=JSON.parse(t)}},addNew:function(){this.$refs.baseDialog.dialogVisible=!0;var e=i()(this.equmentform1);this.equmentform=JSON.parse(e);var t=localStorage.getItem("contractPhone");this.$set(this.equmentform,"smsPhones",t)},closeDialog:function(e){"联网部件信息"==e?this.$refs.network_detail.resetFields():"消防设备信息"==e&&this.$refs.form.resetFields()},deleteTotal:function(e){var t=this;console.log(e);var r=e.deviceId;this.$axios.delete(this.$api.DeleteFireAlarmDevice,{params:{DeviceId:r}}).then(function(e){console.log("删除成功",e),e.data.success&&(t.$message({message:"删除该条数据成功",type:"success"}),t.GetFireAlarmDeviceList())}).catch(function(e){console.log("删除是被",e)})},showdetails:function(e){var t=this;this.$refs.baseDialog.dialogVisible=!0;var r=e.deviceId;this.$axios.all([this.$axios.get(this.$api.GetSerialPortParam,{params:{DeviceId:r}}),this.$axios.get(this.$api.GetFireAlarmDevice,{params:{DeviceId:r}})]).then(this.$axios.spread(function(e,r){if(console.log("获取串口参数成功",e),e.data.success&&(t.PortParam=e.data.result),console.log("获取联网设施详情",r),r.data.success){var a=i()(r.data.result);t.equmentform=JSON.parse(a)}}))},refreshPortParam:function(){var e=this;this.loading=!0;var t=this.equmentform.deviceId;this.$axios.get(this.$api.GetSerialPortParam,{params:{DeviceId:t}}).then(function(t){console.log("刷新串口参数成功",t),t.data.success&&(e.loading=!1,e.PortParam=t.data.result,e.$message({message:"串口参数刷新成功",type:"success"}))}).catch(function(e){console.log("刷新串口参数失败",e)})},getdialogContent:function(e,t){console.log("name",t,e),"故障部件数量"==t?(this.$refs.faultListDialog.dialogVisible=!0,this.FaultPage.fireAlarmDeviceId=e.deviceId,this.GetFireAlarmFaultDetectorList()):"30天火警数量"==t?(this.alarm30_high_title="火警联网系统30天火警记录",this.$refs.fireRecord_highFrequencyDialog.dialogVisible=!0,this.Alarm30Day_highPage.fireAlarmDeviceId=e.deviceId,this.Alarm30Day_toptips_deviceSn=e.deviceSn,this.Alarm30Day_toptips_fireUnitArchitectureName=e.fireUnitArchitectureName,this.Alarm30Day_highThead=this.Alarm30DayThead,this.Alarm30Day_highPage.SkipCount=0,this.Alarm30Day_highPage.current=1,this.GetFireAlarm30DayList(this.Alarm30Day_highPage)):"高频部件数量"==t&&(this.alarm30_high_title="火警联网高频报警数量",this.Alarm30Day_highThead=this.highThead,this.Alarm30Day_highPage.fireAlarmDeviceId=e.deviceId,this.Alarm30Day_toptips_deviceSn=e.deviceSn,this.Alarm30Day_toptips_fireUnitArchitectureName=e.fireUnitArchitectureName,this.Alarm30Day_highPage.SkipCount=0,this.Alarm30Day_highPage.current=1,console.log("Alarm30Day_highPage",this.Alarm30Day_highPage),this.$refs.fireRecord_highFrequencyDialog.dialogVisible=!0,this.GetFireAlarmHighList(this.Alarm30Day_highPage))},GetFireAlarmFaultDetectorList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmFaultDetectorList,{params:this.FaultPage}).then(function(t){e.loading=!1,console.log("打印获取故障设施列表",t);var r=t.data.result;e.faultData=r.items,e.faultTotalCount=r.totalCount}).catch(function(e){console.log("打印获取故障设施列表失败",e)})},fault_next_prevPage:function(e){this.FaultPage.SkipCount=(e-1)*this.FaultPage.MaxResultCount,this.FaultPage.current=e,this.GetFireAlarmFaultDetectorList(this.FaultPage)},GetFireAlarm30DayList:function(e){var t=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarm30DayList,{params:e}).then(function(e){console.log("获取30天火警数量成功",e),t.loading=!1;var r=e.data.result;t.Alarm30Day_highData=r.items,t.Alarm30Day_highTotal=r.totalCount;var a=!0,i=!1,o=void 0;try{for(var l,s=n()(t.Alarm30Day_highData);!(a=(l=s.next()).done);a=!0){var c=l.value;c.alarmTime=t.deal(c.alarmTime)}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}}).catch(function(e){console.log("获取30天火警数量失败",e)})},deal:function(e){var t=e.split("T"),r=t[1].split(".");return t[0]+" "+r[0]},GetFireAlarmHighList:function(e){var t=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmHighList,{params:e}).then(function(e){console.log("获取高频报警数量成功",e),t.loading=!1;var r=e.data.result;t.Alarm30Day_highData=r.items,t.Alarm30Day_highTotal=r.totalCount}).catch(function(e){console.log("获取高频报警数量失败",e)})},next_prevPage:function(e){console.log("page",e),this.Alarm30Day_highPage.current=e,this.Alarm30Day_highPage.SkipCount=(e-1)*this.Alarm30Day_highPage.MaxResultCount,console.log("this.Alarm30Day_highPage",this.Alarm30Day_highPage),"火警联网系统30天火警记录"==this.alarm30_high_title?this.GetFireAlarm30DayList(this.Alarm30Day_highPage):"火警联网高频报警数量"==this.alarm30_high_title&&this.GetFireAlarmHighList(this.Alarm30Day_highPage)},getnetwork:function(e){console.log("getnetworkTable",e),this.networkForm.fireUnitArchitectureName=e.fireUnitArchitectureName;var t={};t.fireUnitArchitectureName=e.fireUnitArchitectureName,t.fireUnitArchitectureId=e.fireUnitArchitectureId,t.deviceSn=e.deviceSn,t.fireAlarmDeviceId=e.fireAlarmDeviceId,localStorage.setItem("networkForm",i()(t)),this.$refs.networkDialog.dialogVisible=!0,this.networkPage.DeviceSn=e.deviceSn,this.networkPage.fireAlarmDeviceId=e.deviceId,this.networkPage.SkipCount=0,this.networkPage.current=1,this.GetDeviceDetectorList(),this.getneteorktypes_build(t)},GetDeviceDetectorList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetDeviceDetectorList,{params:this.networkPage}).then(function(t){console.log("获取该条联网部件",t),e.loading=!1;var r=t.data.result;e.networkData=r.items,e.networktotalCount=r.totalCount,0==t.data.result.items.length&&t.data.result.totalCount>0&&(e.networkPage.SkipCount=0,e.GetDeviceDetectorList())}).catch(function(e){console.log("获取该条联网部件失败",e)})},network_prev_next:function(e){this.networkPage.SkipCount=(e-1)*this.networkPage.MaxResultCount,console.log("this.networkPage",this.networkPage),this.networkPage.current=e,this.GetDeviceDetectorList()},addNetworkcomponents:function(){this.networkForm={};var e=JSON.parse(localStorage.getItem("networkForm"));this.networkForm.fireUnitArchitectureName=e.fireUnitArchitectureName,this.networkForm.fireUnitArchitectureId=e.fireUnitArchitectureId,this.networkForm.deviceSn=e.deviceSn,this.$refs.network_detailDialog.dialogVisible=!0},getneteorktypes_build:function(e){var t=this;console.log("获取联网部件的楼层和部件类型");var r=localStorage.getItem("fireUnitID");this.$axios.all([this.$axios.get(this.$api.GetFireAlarmDetectorTypes,{params:{}}),this.$axios.get(this.$api.GetListByFireUnitId,{params:{fireunitId:r}})]).then(this.$axios.spread(function(r,a){if(console.log("获取部件类型",r),t.FireAlarmDetectorTypes=r.data.result,console.log("获取所在建筑 的楼层",a),console.log("名字相等",e.fireUnitArchitectureName),a.data.result.length>0){var i=!0,o=!1,l=void 0;try{for(var s,c=n()(a.data.result);!(i=(s=c.next()).done);i=!0){var u=s.value;e.fireUnitArchitectureName==u.name&&(t.fireUnitArchitecturefloors=u.floors)}}catch(e){o=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw l}}}}))},add_updatenetwork:function(){var e=this;console.log(this.networkForm),this.$refs.network_detail.validate(function(t){t&&(e.networkForm.detectorId?e.$axios.put(e.$api.UpdateFireAlarmDetector,e.networkForm):e.$axios.post(e.$api.AddFireAlarmDetector,e.networkForm)).then(function(t){console.log("新增或修改联网部件成功",t),t.data.success&&(e.$refs.network_detailDialog.dialogVisible=!1,e.$message.success((e.networkForm.detectorId?"修改":"新增")+"联网部件成功"),e.GetDeviceDetectorList(JSON.parse(localStorage.getItem("networkForm")).deviceSn))}).catch(function(e){console.log("新增或修改联网部件失败",e)})})},network_cancel:function(){},showdetails_network:function(e){console.log("联网部件详情",e),this.$refs.network_detailDialog.dialogVisible=!0,this.networkForm=e},DeleteDetector:function(e){var t=this,r=e.detectorId;this.$axios.delete(this.$api.DeleteDetector,{params:{DetectorId:r}}).then(function(e){console.log("删除",e),t.$message({message:"删除该条数据成功",type:"success"}),t.GetDeviceDetectorList(JSON.parse(localStorage.getItem("networkForm")).deviceSn)})},Import:function(){this.$refs.network_importDialog.dialogVisible=!0},download:function(){var e=document.createElement("a");e.style.display="none",e.href="http://futest.sctsjkj.com/template/消防火警联网部件设施数据表.xlsx",e.click()},handleExceed:function(){this.$notify({title:"警告",message:"只能上传一个文件哦!,若需要上传其他文件请先移除已选择的文件",type:"warning"})},uploadFile:function(e){var t=this,r=new FormData;r.append("FireAlarmDeviceSn",this.networkPage.DeviceSn),r.append("file",e.file),this.$axios.post(this.$api.ImportFireAlarmDetector,r).then(function(e){console.log("res",e),e.data.result.success?(t.$message({message:"导入数据成功!",type:"success"}),t.GetDeviceDetectorList()):t.$message({showClose:!0,message:"导入失败！"+e.data.result.failCause,type:"error",duration:"6000"}),t.fileList=[],t.$refs.network_importDialog.dialogVisible=!1}).catch(function(e){console.log("err",e)})},beforeAvatarUpload:function(e){var t="xls"===e.name.split(".")[1],r="xlsx"===e.name.split(".")[1];t||r||alert("上传模板只能是 xls、xlsx格式!")},submitUpload:function(){var e=this;this.$confirm("导入的方式会覆盖现有的记录, 是否继续?","导入数据",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$refs.upload.submit()}).catch(function(){})}}}),p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"firenetworkingBox"},[r("div",{staticClass:"top_tips"},[r("div",{staticClass:"tooltip"},[r("el-button",{attrs:{type:"primary",plain:"",round:""},on:{click:function(t){return e.screen("全部")}}},[e._v("\n        全部\n        "),"全部"==e.screensign?r("i",{staticClass:"el-icon-check  el-icon--right"}):e._e()]),e._v(" "),r("el-button",{attrs:{type:"success",plain:"",round:""},on:{click:function(t){return e.screen("在线")}}},[e._v("\n        在线："+e._s(e.firenetworkState.online)+"\n        "),"在线"==e.screensign?r("i",{staticClass:"el-icon-check  el-icon--right"}):e._e()]),e._v(" "),r("el-button",{attrs:{type:"info",plain:"",round:""},on:{click:function(t){return e.screen("离线")}}},[e._v("\n        离线："+e._s(e.firenetworkState.offline)+"\n        "),"离线"==e.screensign?r("i",{staticClass:"el-icon-check  el-icon--right"}):e._e()])],1),e._v(" "),r("el-button",{on:{click:e.addNew}},[e._v("新增")])],1),e._v(" "),r("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.tableThead,tableData:e.tableData,ishownetworkBtn:!0,pageSize:10,totalCount:e.totalCount},on:{pageChange:e.AlarmDeviceList_prev_next,getnetwork:e.getnetwork,getdialogContent:e.getdialogContent,showdetails:e.showdetails,deleteInfo:e.deleteTotal}}),e._v(" "),r("baseDialog",{ref:"baseDialog",attrs:{title:"消防设备信息"},on:{closeDialog:e.closeDialog}},[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"formBox",attrs:{rules:e.rules,model:e.equmentform,"label-width":"80px"}},[r("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[r("el-col",{staticClass:"left_box",attrs:{span:4}},[r("div",{staticClass:"grid-content basetitle"},[e._v("基本")])]),e._v(" "),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"grid-content"},[r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"设备型号",prop:"deviceModel"}},[r("el-select",{attrs:{placeholder:"请选择设备型号"},model:{value:e.equmentform.deviceModel,callback:function(t){e.$set(e.equmentform,"deviceModel",t)},expression:"equmentform.deviceModel"}},e._l(e.DeviceTypes,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("p",{staticClass:"marginleft10"},[e._v("设备名称：火警联网设施")])])],1),e._v(" "),r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"设备编号",prop:"deviceSn"}},[r("el-input",{attrs:{placeholder:"设备编号"},model:{value:e.equmentform.deviceSn,callback:function(t){e.$set(e.equmentform,"deviceSn",t)},expression:"equmentform.deviceSn"}})],1)],1),e._v(" "),e.equmentform.deviceId?r("el-col",{attrs:{span:12}},["在线"==e.equmentform.state?r("p",{staticClass:"marginleft10"},[e._v("设备状态："),r("span",{staticClass:"green"},[e._v(e._s(e.equmentform.state))])]):e._e(),e._v(" "),"离线"==e.equmentform.state?r("p",{staticClass:"marginleft10"},[e._v("设备状态："),r("span",{staticClass:"red"},[e._v(e._s(e.equmentform.state))])]):e._e()]):e._e()],1)],1)])],1),e._v(" "),r("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[r("el-col",{staticClass:"left_box",attrs:{span:4}},[r("div",{staticClass:"grid-content basetitle"},[e._v("消防主机")])]),e._v(" "),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"grid-content"},[r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所在建筑",prop:"fireUnitArchitectureId"}},[r("el-select",{attrs:{disabled:!!e.equmentform.deviceId,placeholder:"请选择所在建筑"},model:{value:e.equmentform.fireUnitArchitectureId,callback:function(t){e.$set(e.equmentform,"fireUnitArchitectureId",t)},expression:"equmentform.fireUnitArchitectureId"}},e._l(e.buildList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("el-col",{staticClass:"networkNum",attrs:{span:12}},[r("el-form-item",{attrs:{label:"品牌："}},[r("el-input",{attrs:{placeholder:"请输入品牌"},model:{value:e.equmentform.brand,callback:function(t){e.$set(e.equmentform,"brand",t)},expression:"equmentform.brand"}})],1)],1)],1),e._v(" "),r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"通讯协议",prop:"protocol"}},[r("el-select",{attrs:{placeholder:"请选择通讯协议"},model:{value:e.equmentform.protocol,callback:function(t){e.$set(e.equmentform,"protocol",t)},expression:"equmentform.protocol"}},e._l(e.DeviceProtocols,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),r("el-col",{staticClass:"networkNum",attrs:{span:12}},[r("el-form-item",{attrs:{label:"联网部件数量：",prop:"netDetectorNum"}},[r("el-input",{attrs:{placeholder:"请输入联网部件数量"},model:{value:e.equmentform.netDetectorNum,callback:function(t){e.$set(e.equmentform,"netDetectorNum",e._n(t))},expression:"equmentform.netDetectorNum"}})],1)],1)],1)],1)])],1),e._v(" "),r("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[r("el-col",{staticClass:"left_box",attrs:{span:4}},[r("div",{staticClass:"grid-content basetitle"},[e._v("参数")])]),e._v(" "),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"grid-content"},[r("el-row",{staticClass:"pd20"},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"发现故障",prop:"Model"}},[r("el-checkbox-group",{model:{value:e.equmentform.enableFault,callback:function(t){e.$set(e.equmentform,"enableFault",t)},expression:"equmentform.enableFault"}},[r("el-checkbox",{attrs:{label:"云端报警"}}),e._v(" "),r("el-checkbox",{attrs:{label:"发送短信"}}),e._v(" "),r("el-checkbox",{attrs:{label:"发送开关量信号"}})],1)],1)],1)],1),e._v(" "),r("el-row",{staticClass:"pd20"},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"发现火警",prop:"Model"}},[r("el-checkbox-group",{model:{value:e.equmentform.enableAlarm,callback:function(t){e.$set(e.equmentform,"enableAlarm",t)},expression:"equmentform.enableAlarm"}},[r("el-checkbox",{attrs:{label:"云端报警"}}),e._v(" "),r("el-checkbox",{attrs:{label:"发送短信"}}),e._v(" "),r("el-checkbox",{attrs:{label:"发送开关量信号"}})],1)],1),e._v(" "),-1!=e.equmentform.enableAlarm.indexOf("发送短信")||-1!=e.equmentform.enableFault.indexOf("发送短信")?r("el-col",{staticClass:"smsPhones",attrs:{span:16}},[r("el-form-item",{attrs:{label:"接收手机"}},[r("el-input",{attrs:{placeholder:"请输入接收手机号码(输入多个时需要用英文逗号隔开)"},model:{value:e.equmentform.smsPhones,callback:function(t){e.$set(e.equmentform,"smsPhones",t)},expression:"equmentform.smsPhones"}})],1)],1):e._e()],1)],1),e._v(" "),r("div",[r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"串口参数",prop:"comType"}},[r("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.equmentform.comType,callback:function(t){e.$set(e.equmentform,"comType",t)},expression:"equmentform.comType"}},e._l(e.types,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"波特率",prop:"baudRate"}},[r("el-select",{attrs:{placeholder:"请选择波特率"},model:{value:e.equmentform.baudRate,callback:function(t){e.$set(e.equmentform,"baudRate",t)},expression:"equmentform.baudRate"}},e._l(e.Baudrates,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),r("el-row",{staticClass:"pd20",attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"通讯方式",prop:"netComm"}},[r("el-select",{attrs:{placeholder:"请选择通讯方式"},model:{value:e.equmentform.netComm,callback:function(t){e.$set(e.equmentform,"netComm",t)},expression:"equmentform.netComm"}},[r("el-option",{attrs:{label:"以太网",value:"以太网"}}),e._v(" "),r("el-option",{attrs:{label:"WIFI",value:"WIFI"}}),e._v(" "),r("el-option",{attrs:{label:"NB-IOT",value:"NB-IOT"}}),e._v(" "),r("el-option",{attrs:{label:"4G",value:"4G"}})],1)],1)],1)],1)],1)],1)])],1),e._v(" "),r("el-row",{staticClass:"btns",attrs:{gutter:20}},[r("el-button",{on:{click:e.add_update_equment}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:function(t){return e.cancel(e.equmentform.deviceId)}}},[e._v("取消")])],1)],1)],1),e._v(" "),r("baseDialog",{ref:"networkDialog",staticClass:"networkDialog",attrs:{title:"火警联网部件"}},[r("div",{staticClass:"topBox"},[r("el-button",{on:{click:e.Import}},[e._v("导入")]),e._v(" "),r("el-button",{staticClass:"add",on:{click:e.addNetworkcomponents}},[e._v("新增")])],1),e._v(" "),r("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",totalCount:e.networktotalCount,pageSize:5,tableThead:e.networkThead,tableData:e.networkData,currentpage:e.networkPage.current},on:{pageChange:e.network_prev_next,showdetails:e.showdetails_network,deleteInfo:e.DeleteDetector}})],1),e._v(" "),r("baseDialog",{ref:"network_detailDialog",attrs:{title:"联网部件信息"},on:{closeDialog:e.closeDialog}},[r("el-form",{ref:"network_detail",staticClass:"network_detail-form",attrs:{rules:e.networkFormrules,"label-width":"120px",model:e.networkForm}},[r("el-form-item",{attrs:{label:"部件地址：",prop:"identify"}},[r("el-input",{attrs:{placeholder:"请输入部件地址（必填）"},model:{value:e.networkForm.identify,callback:function(t){e.$set(e.networkForm,"identify",t)},expression:"networkForm.identify"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"部件类型：",prop:"detectorTypeName"}},[r("el-select",{attrs:{placeholder:"请选择部件类型"},model:{value:e.networkForm.detectorTypeName,callback:function(t){e.$set(e.networkForm,"detectorTypeName",t)},expression:"networkForm.detectorTypeName"}},e._l(e.FireAlarmDetectorTypes,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),r("p",{staticClass:"build"},[e._v("\n            所在建筑：\n            "),r("span",[e._v(e._s(e.networkForm.fireUnitArchitectureName))])]),e._v(" "),r("el-form-item",{attrs:{label:"楼层：",prop:"fireUnitArchitectureFloorId"}},[r("el-select",{attrs:{placeholder:"请选择所在楼层"},model:{value:e.networkForm.fireUnitArchitectureFloorId,callback:function(t){e.$set(e.networkForm,"fireUnitArchitectureFloorId",t)},expression:"networkForm.fireUnitArchitectureFloorId"}},e._l(e.fireUnitArchitecturefloors,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"安装位置：",prop:"location"}},[r("el-input",{attrs:{placeholder:"请输入安装位置"},model:{value:e.networkForm.location,callback:function(t){e.$set(e.networkForm,"location",t)},expression:"networkForm.location"}})],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:e.add_updatenetwork}},[e._v("提交")]),e._v(" "),r("el-button",{staticClass:"cancel",on:{click:e.network_cancel}},[e._v("取消")])],1)],1)],1),e._v(" "),r("baseDialog",{ref:"network_importDialog",staticClass:"network_importDialog",attrs:{title:"联网部件导入"}},[r("div",{staticClass:"dialog_content"},[r("p",{staticClass:"tips"},[e._v("注：导入的方式会覆盖现有的记录，如果要新增部分联网部件，请使用“新增”功能")]),e._v(" "),r("div",{staticClass:"build"},[r("p",[r("span",[e._v("所在建筑：")]),e._v(" "),r("span",[e._v(e._s(this.networkForm.fireUnitArchitectureName))])])]),e._v(" "),r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",name:"excelFile",multiple:!1,limit:1,"on-exceed":e.handleExceed,"http-request":e.uploadFile,"before-upload":e.beforeAvatarUpload,"file-list":e.fileList,"auto-upload":!1}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[r("p",[e._v("只能上传excel文件")])])],1),e._v(" "),r("div",{staticClass:"bottom"},[r("span",{on:{click:e.download}},[e._v("模板下载")])])],1)]),e._v(" "),r("baseDialog",{ref:"faultListDialog",staticClass:"threedialog",attrs:{title:"火警联网系统故障部件"}},[r("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.faultThead,tableData:e.faultData,pageSize:5,totalCount:e.faultTotalCount},on:{pageChange:e.fault_next_prevPage}})],1),e._v(" "),r("baseDialog",{ref:"fireRecord_highFrequencyDialog",staticClass:"threedialog",attrs:{title:e.alarm30_high_title}},[r("div",{staticClass:"top_tips"},[e._v("火警联网设备编号："+e._s(e.Alarm30Day_toptips_deviceSn)+" "),r("span",[e._v("所在建筑："+e._s(e.Alarm30Day_toptips_fireUnitArchitectureName))])]),e._v(" "),r("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.Alarm30Day_highThead,tableData:e.Alarm30Day_highData,pageSize:5,currentpage:e.Alarm30Day_highPage.current,totalCount:e.Alarm30Day_highTotal},on:{pageChange:e.next_prevPage}})],1)],1)},staticRenderFns:[]};var f=r("VU/8")(m,p,!1,function(e){r("UGPn")},null,null);t.default=f.exports},c45H:function(e,t,r){r("1alW"),e.exports=r("FeBl").Number.isInteger},fC4T:function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}}});
//# sourceMappingURL=5.65e08a9a4c5cd623854d.js.map