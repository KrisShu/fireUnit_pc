webpackJsonp([8],{"9bBU":function(t,e,a){a("mClu");var n=a("FeBl").Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},aiZt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("bOdI"),i=a.n(n),o=a("BO1k"),l=a.n(o),s=a("Nn1j"),r=localStorage.getItem("fireUnitID"),c={components:{baseTable:s.a},data:function(){return{form:{type:["在线","离线"]},tableThead:[{name:"终端部件",prop:"name"},{name:"安装位置",prop:"location"},{name:"网关状态",prop:"stateName"},{name:"当前数据",prop:"analog"},{name:"合格范围",prop:"standard"},{name:"历史记录"}],tableData:[],totalCount:0,offlineCount:0,MaxResultCount:10,specailText:"历史记录",dialogTitle:"历史记录",dialogVisible_offline:!1,dialogVisible_online:!1,status:"在线",UnAn_lastTimeStateChange:"",UnAn_location:"",UnAn_name:"",UnAn_state:"",unAnalogTimes:"",analogTimes:"",an_lastTimeStateChange:"",an_location:"",an_name:"",an_state:"",Option:0,dataPage:1}},methods:{goto:function(){this.$router.push({path:"/test"})},screenData:function(){console.log("this.form",this.form),"在线"==this.form.type?(this.Option=1,this.fireUnitEndDeviceState(1,1)):"离线"==this.form.type?(this.Option=-1,this.fireUnitEndDeviceState(1,-1)):2==this.form.type.length?(this.Option=0,this.fireUnitEndDeviceState(1,0)):this.form.type.length},fireUnitEndDeviceState:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this;this.$axios({method:"get",url:a.$api.GetFireUnitEndDeviceState,params:{FireUnitId:r,SkipCount:(t-1)*a.MaxResultCount,MaxResultCount:a.MaxResultCount,Option:e}}).then(function(t){console.log("物联终端初始化",t),a.tableData=t.data.result.items,a.totalCount=t.data.result.totalCount,a.offlineCount=t.data.result.offlineCount}).catch(function(t){console.log("物联终端初始化失败",t)})},recordAnalog:function(t){var e=this;this.$axios({method:"get",url:e.$api.GetRecordAnalog,params:{DetectorId:t,FireUnitId:r}}).then(function(t){console.log("获得防火单位模拟量终端历史记录成功",t),e.analogTimes=t.data.result.analogTimes,e.an_lastTimeStateChange=t.data.result.lastTimeStateChange,e.an_location=t.data.result.location,e.an_name=t.data.result.name,e.an_state=t.data.result.state,e.$nextTick(function(){e.offLineEharts(e.analogTimes)})}).catch(function(t){console.log("获得防火单位模拟量终端历史记录失败",t)})},recordUnAnalog:function(t){var e=this;this.$axios({method:"get",url:e.$api.GetRecordUnAnalog,params:{DetectorId:t,FireUnitId:r}}).then(function(t){console.log("非模拟量终端历史记录",t),e.UnAn_lastTimeStateChange=t.data.result.lastTimeStateChange,e.UnAn_location=t.data.result.location,e.UnAn_name=t.data.result.name,e.UnAn_state=t.data.result.state,e.unAnalogTimes=t.data.result.unAnalogTimes,e.$nextTick(function(){console.log("that.unAnalogTimes",e.unAnalogTimes),e.onLineEharts(e.unAnalogTimes)})}).catch(function(t){console.log("非模拟量终端历史记录失败",t)})},showDialog:function(t){console.log("状态",t),this.status=t.isAnalog,0==this.status?(console.log("detectorId",t.detectorId),this.recordUnAnalog(t.detectorId),this.dialogVisible_online=!0):1==this.status&&(this.dialogVisible_offline=!0,this.recordAnalog(t.detectorId))},prevClick:function(t){console.log("上一页",t),this.dataPage=t,this.fireUnitEndDeviceState(t,this.Option)},currentChange:function(t){console.log("点击页数",t),this.dataPage=t,this.fireUnitEndDeviceState(t,this.Option)},nextClick:function(t){console.log("点击下一页",t),this.dataPage=t,this.fireUnitEndDeviceState(t,this.Option)},offLineEharts:function(t){var e=[],a=[],n=!0,i=!1,o=void 0;try{for(var s,r=l()(t);!(n=(s=r.next()).done);n=!0){var c=s.value;e.push(c.time),a.push(c.value)}}catch(t){i=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}this.$echarts.init(document.getElementById("offLineEchart")).setOption({color:["#00b4ff"],grid:{left:50,top:10,right:10,bottom:100},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:e,axisLine:{lineStyle:{color:"#42749e"}},axisLabel:{textStyle:{fontSize:12,color:"white"},interval:0,rotate:45}},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{color:["#42749e"]}},axisLine:{lineStyle:{color:"#42749e"}},axisLabel:{textStyle:{fontSize:12,color:"white"}}},series:[{data:a,type:"line",symbol:"circle",symbolSize:10}]})},onLineEharts:function(t){var e;console.log("unAnalogTimes",t);var a=this.$echarts.init(document.getElementById("onLineEchart")),n=[],o=[],s=[],r=[],c=!0,u=!1,d=void 0;try{for(var f,h=l()(t);!(c=(f=h.next()).done);c=!0){var p=f.value;r.push(p.time),n.push(p.offlineCount),o.push(p.alarmCount),s.push(p.faultCount)}}catch(t){u=!0,d=t}finally{try{!c&&h.return&&h.return()}finally{if(u)throw d}}console.log("dateData",r,s),a.setOption((e={color:["#00a2ff","#ff8a00","#e8e23f"],grid:{left:40,top:0,right:10,bottom:40},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["离线次数","报火警次数","报故障次数"],padding:[5,20,0,20],textStyle:{color:"white"}}},i()(e,"grid",{left:"3%",right:"4%",bottom:"3%",containLabel:!0}),i()(e,"yAxis",{type:"value",boundaryGap:[0,.01],splitLine:{show:!0,lineStyle:{color:["#42749e"]}},axisLine:{lineStyle:{color:"#42749e"}},axisLabel:{textStyle:{fontSize:12,color:"white"}}}),i()(e,"xAxis",{type:"category",data:r,axisLine:{lineStyle:{color:"#42749e"}},axisLabel:{textStyle:{fontSize:12,color:"white"},interval:0,rotate:45}}),i()(e,"series",[{name:"离线次数",type:"bar",data:n},{name:"报警次数",type:"bar",data:o},{name:"报故障次数",type:"bar",data:n}]),e))}},mounted:function(){this.fireUnitEndDeviceState(1)}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"materialLinkTerminal"},[a("div",{staticClass:"screenBox"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"网关状态："}},[a("el-checkbox-group",{on:{change:t.screenData},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-checkbox",{attrs:{label:"在线",name:"type"}}),t._v(" "),a("el-checkbox",{attrs:{label:"离线",name:"type"}})],1)],1)],1),t._v(" "),a("span",[t._v("终端离线数量："+t._s(t.offlineCount))])],1),t._v(" "),a("base-table",{attrs:{totalCount:t.totalCount,tableThead:t.tableThead,tableData:t.tableData,specailText:t.specailText},on:{showDialog:t.showDialog,prevClick:t.prevClick,currentChange:t.currentChange,nextClick:t.nextClick}}),t._v(" "),a("el-dialog",{attrs:{title:"历史记录",visible:t.dialogVisible_offline},on:{"update:visible":function(e){t.dialogVisible_offline=e}}},[a("div",{staticClass:"dialog-offline"},[a("p",[t._v("终端部件："+t._s(t.an_name))]),t._v(" "),a("p",[t._v(" 安装地址："+t._s(t.an_location))]),t._v(" "),a("p",[t._v(" 网关状态："+t._s(t.an_state))]),t._v(" "),a("p",[t._v("网关状态最近变化时间："+t._s(t.an_lastTimeStateChange))]),t._v(" "),a("p",{staticClass:"echartsTitle"},[t._v("终端数值历史记录（单位：mA）")]),t._v(" "),a("div",{attrs:{id:"offLineEchart"}})])]),t._v(" "),a("el-dialog",{attrs:{title:"历史记录",visible:t.dialogVisible_online},on:{"update:visible":function(e){t.dialogVisible_online=e}}},[a("div",{staticClass:"dialog-online"},[a("p",[t._v("终端部件："+t._s(t.UnAn_name))]),t._v(" "),a("p",[t._v("安装地址："+t._s(t.UnAn_location))]),t._v(" "),a("p",[t._v("网关状态："),a("span",[t._v(t._s(t.UnAn_state))])]),t._v(" "),a("p",[t._v("网关状态最近变化时间："+t._s(t.UnAn_lastTimeStateChange))]),t._v(" "),a("p",{staticClass:"echartsTitle"},[t._v("终端历史记录小计")]),t._v(" "),a("div",{attrs:{id:"onLineEchart"}})])])],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(t){a("lS0r")},null,null);e.default=d.exports},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var n,i=a("C4MV"),o=(n=i)&&n.__esModule?n:{default:n};e.default=function(t,e,a){return e in t?(0,o.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},lS0r:function(t,e){},mClu:function(t,e,a){var n=a("kM2E");n(n.S+n.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})}});
//# sourceMappingURL=8.4bc62a77c5ec4d694bac.js.map