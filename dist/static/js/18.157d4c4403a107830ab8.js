webpackJsonp([18],{A7SN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("BO1k"),i=a.n(l),n=a("Nn1j"),r=a("HR9O"),s={components:{baseTable:n.a,baseDialog:r.a},data:function(){return{loading:!1,screensign:"全部",buttonarr:[{type:"primary",text:"全部"},{type:"warning",text:"未处理",num:0},{type:"success",text:"已处理",num:0}],tableThead:[{name:"报警时间",prop:"creationTime"},{name:"设备编号",prop:"fireElectricDeviceSn"},{name:"所在建筑",prop:"fireUnitArchitectureName"},{name:"所在楼层",prop:"fireUnitArchitectureFloorName"},{name:"具体位置",prop:"location"},{name:"状态",prop:"state"},{name:"报警数值",prop:"analog",prop1:"sign"},{name:"处理",prop:"alarmHandleStatus"}],tableData:[],totalCount:0,page:{FireUnitId:localStorage.getItem("fireUnitID"),VisitSource:1,HandleStatusFilter:1,State:0,SkipCount:0,MaxResultCount:10},form:{CheckState:4,CheckContent:""},alarmDataId:"",alarmHandleStatus:"",details:{}}},created:function(){this.GetElectricAlarmList(),this.GetElectricAlarmCheckStatusNum()},methods:{GetElectricAlarmCheckStatusNum:function(){var t=this;this.$axios.get(this.$api.GetElectricAlarmCheckStatusNum,{params:{fireUnitId:localStorage.getItem("fireUnitID")}}).then(function(e){t.buttonarr[1].num=e.data.result[0].value,t.buttonarr[2].num=e.data.result[1].value})},screen:function(t){this.screensign=t,"未处理"==t?this.page.HandleStatusFilter=3:"已处理"==t?this.page.HandleStatusFilter=2:"全部"==t&&(this.page.HandleStatusFilter=1),this.page.SkipCount=0,this.GetElectricAlarmList()},GetElectricAlarmList:function(){var t=this;this.loading=!0,this.$axios.get(this.$api.GetElectricAlarmList,{params:this.page}).then(function(e){console.log("获取电气火灾",e),t.loading=!1;var a=!0,l=!1,n=void 0;try{for(var r,s=i()(e.data.result.items);!(a=(r=s.next()).done);a=!0){var o=r.value;o.creationTime=t.delTime(o.creationTime)}}catch(t){l=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(l)throw n}}var c=e.data.result;t.totalCount=c.totalCount,t.tableData=c.items})},delTime:function(t){var e=t.split("T"),a=e[1].split(".");return e[0]+" "+a[0]},dealDetail:function(t){console.log("dealDetail",t),this.$refs.baseDialog.dialogVisible=!0,this.alarmDataId=t.alarmDataId,this.alarmHandleStatus=t.alarmHandleStatus,1!=t.alarmHandleStatus&&this.GetElectricAlarmCheckDetail(t.alarmDataId)},GetElectricAlarmCheckDetail:function(t){var e=this;this.$axios.get(this.$api.GetElectricAlarmCheckDetail,{params:{alarmId:t}}).then(function(t){if(console.log("详情",t),t.data.result.handleTime=e.delTime(t.data.result.handleTime),t.data.result.handleVoiceUrl){t.data.result.handleVoiceUrl=""+e.$URL+t.data.result.handleVoiceUrl;var l=a("/y4m");e.amr=new l,e.amr.initWithUrl(t.data.result.handleVoiceUrl)}e.details=t.data.result})},playVioce:function(){this.amr.play(),this.amr.onEnded(function(){console.log("播放完毕")})},submit:function(){var t=this,e=new FormData;e.append("CheckState",this.form.CheckState),e.append("CheckUserId ",localStorage.getItem("userId")),e.append("AlarmDataId",this.alarmDataId),e.append("CheckContent",this.form.CheckContent),this.$axios.post(this.$api.CheckElectricAlarm,e).then(function(e){console.log("请求",e),e.data.success&&(t.form.CheckState=4,t.form.CheckContent="",t.$refs.baseDialog.dialogVisible=!1,t.GetElectricAlarmList(),t.GetElectricAlarmCheckStatusNum())})},prev_next:function(t){this.page.SkipCount=(t-1)*this.page.MaxResultCount,this.GetElectricAlarmList()}}},o={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"hiddeElectric"},[l("div",{staticClass:"topStatus"},t._l(t.buttonarr,function(e){return l("el-button",{key:e.text,attrs:{round:"",plain:"",type:e.type},on:{click:function(a){return t.screen(e.text)}}},[t.screensign==e.text?l("i",{staticClass:"el-icon-check  el-icon--right"}):t._e(),t._v("\n              "+t._s(e.text)+" "+t._s(e.num)+"\n          ")])}),1),t._v(" "),l("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:t.tableThead,tableData:t.tableData,totalCount:t.totalCount,pageSize:10},on:{pageChange:t.prev_next,dealDetail:t.dealDetail}}),t._v(" "),l("baseDialog",{ref:"baseDialog",attrs:{title:"警情处理",width:"40%"}},[1==t.alarmHandleStatus?l("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"情况处理："}},[l("el-radio-group",{model:{value:t.form.CheckState,callback:function(e){t.$set(t.form,"CheckState",e)},expression:"form.CheckState"}},[l("el-radio",{attrs:{label:4}},[t._v("忽略")]),t._v(" "),l("el-radio",{attrs:{label:2}},[t._v("误报")]),t._v(" "),l("el-radio",{attrs:{label:3}},[t._v("已处理")])],1)],1),t._v(" "),l("el-form-item",{attrs:{label:"情况描述："}},[l("el-input",{attrs:{type:"textarea",placeholder:"情况简要描述，200字以内",rows:"10"},model:{value:t.form.CheckContent,callback:function(e){t.$set(t.form,"CheckContent",e)},expression:"form.CheckContent"}})],1),t._v(" "),l("el-button",{on:{click:t.submit}},[t._v("提交")])],1):l("div",{staticClass:"detailsBox"},[l("p",[t._v("处理时间："),l("span",[t._v(t._s(t.details.handleTime))])]),t._v(" "),l("p",[t._v("处理状态：\n              "),2==t.details.alarmHandleStatus?l("span",[t._v("误报")]):t._e(),t._v(" "),3==t.details.alarmHandleStatus?l("span",[t._v("已处理")]):t._e(),t._v(" "),4==t.details.alarmHandleStatus?l("span",[t._v("忽略")]):t._e()]),t._v(" "),l("div",[t.details.handleContent?l("p",{staticClass:"handleContent"},[t._v("情况描述："),l("span",[t._v(t._s(t.details.handleContent))])]):t._e(),t._v(" "),t.details.handleVoiceUrl?l("div",{staticClass:"display_p"},[l("span",[t._v(" 情况描述：")]),t._v(" "),l("div",{staticClass:"vioceUrl",on:{click:function(e){return t.playVioce(t.details.handleVoiceLength)}}},[l("img",{attrs:{src:a("FEo8"),alt:""}}),t._v(" "),l("span",[t._v(t._s(t.details.handleVoiceLength)+'"')])])]):t._e()])])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(s,o,!1,function(t){a("SCgE")},null,null);e.default=c.exports},SCgE:function(t,e){}});
//# sourceMappingURL=18.157d4c4403a107830ab8.js.map