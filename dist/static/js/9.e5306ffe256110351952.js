webpackJsonp([9],{"9bBU":function(t,a,e){e("mClu");var s=e("FeBl").Object;t.exports=function(t,a,e){return s.defineProperty(t,a,e)}},C4MV:function(t,a,e){t.exports={default:e("9bBU"),__esModule:!0}},X5F7:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("BO1k"),i=e.n(s),l=e("bOdI"),n=e.n(l),o=e("Nn1j"),r=e("HR9O"),d={components:{baseTable:o.a,baseDialog:r.a},data:function(){var t;return t={loading:!1,screensign:"待处理",radio:6,buttonarr:[{type:"info",text:"待处理"},{type:"primary",text:"自行处理中",num:0},{type:"warning",text:"维保处理中",num:0},{type:"success",text:"已解决",num:0}],tableThead:[],tableThead1:[{name:"发现时间",prop:"creationTime"},{name:"问题来源",prop:"source"},{name:"问题提交人",prop:"userName"},{name:"操作"}],tableThead2:[{name:"发现时间",prop:"creationTime",width:"280"},{name:"派单时间",prop:"dispatchTime",width:"200"},{name:"问题来源",prop:"source"},{name:"问题提交人",prop:"userName"},{name:"操作"}],tableThead3_1:[{name:"发现时间",prop:"creationTime",width:"280"},{name:"处理完成时间",prop:"safeCompleteTime",width:"200"},{name:"问题来源",prop:"source"},{name:"问题提交人",prop:"userName"},{name:"操作"}],tableThead4:[{name:"发现时间",prop:"creationTime",width:"280"},{name:"解决时间",prop:"solutionTime",width:"200"},{name:"问题来源",prop:"source"},{name:"问题提交人",prop:"userName"},{name:"操作"}],title:"设施故障待处理",tableData:[],totalCount:0,specailText:"查看",amr:Object,page:{FireUnitId:localStorage.getItem("fireUnitID"),HandleStatus:1,SkipCount:0,MaxResultCount:10},detailsData:[],isdel:!1},n()(t,"radio",1),n()(t,"textarea",""),t},created:function(){this.tableDataMethod(),this.tableThead=this.tableThead1},methods:{screen:function(t){this.screensign=t,"待处理"==t?(this.tableThead=this.tableThead1,this.page.HandleStatus=1):"自行处理中"==t?(this.tableThead=this.tableThead2,this.page.HandleStatus=4):"维保处理中"==t?(this.tableThead=this.tableThead3_1,this.radio=6,this.page.HandleStatus=6):"已解决"==t&&(this.tableThead=this.tableThead4,this.page.HandleStatus=3),this.page.SkipCount=0,this.tableDataMethod()},radioChange:function(t){this.page.HandleStatus=t,this.page.SkipCount=0,this.tableDataMethod()},tableDataMethod:function(){var t=this;this.loading=!0,this.$axios.get(this.$api.GetBreakDownlist,{params:this.page}).then(function(a){t.loading=!1,console.log("列表数据",a);var e=!0,s=!1,l=void 0;try{for(var n,o=i()(a.data.result.items);!(e=(n=o.next()).done);e=!0){var r=n.value;r.creationTime=t.deal(r.creationTime),r.dispatchTime=t.deal(r.dispatchTime),r.solutionTime=t.deal(r.solutionTime),r.safeCompleteTime=t.deal(r.safeCompleteTime)}}catch(t){s=!0,l=t}finally{try{!e&&o.return&&o.return()}finally{if(s)throw l}}var d=a.data.result;t.totalCount=d.totalCount,t.tableData=d.items})},deal:function(t){var a=t.split("T"),e=a[1].split(".");return a[0]+" "+e[0]},prev_next:function(t){console.log("page",t),this.page.SkipCount=(t-1)*this.page.MaxResultCount,this.tableDataMethod()},showdetails:function(t){var a=this;console.log("查看详情",t),this.loading=!0;var s=t.breakDownId;1==t.handleStatus?this.title="设施故障待处理":4==t.handleStatus?this.title="自行处理":3==t.handleStatus&&(this.title="设置故障已解决"),this.$refs.basedialog.dialogVisible=!0,this.$axios.get(this.$api.GetBreakDownInfo,{params:{breakDownId:s}}).then(function(t){if(console.log("获取设施故障详情",t),t.data.result.patrolPhotosPath)for(var s=0;s<t.data.result.patrolPhotosPath.length;s++)t.data.result.patrolPhotosPath[s]=""+a.$URL+t.data.result.patrolPhotosPath[s];if(t.data.result.problemVoiceUrl){t.data.result.problemVoiceUrl=""+a.$URL+t.data.result.problemVoiceUrl;var i=e("/y4m");a.amr=new i,a.amr.initWithUrl(t.data.result.problemVoiceUrl)}t.data.result.dispatchTime=a.deal(t.data.result.dispatchTime),t.data.result.creationTime=a.deal(t.data.result.creationTime),t.data.result.solutionTime=a.deal(t.data.result.solutionTime),a.detailsData=t.data.result,a.loading=!1}).catch(function(t){console.log("err",t)})},playVioce:function(){this.amr.play(),this.amr.onEnded(function(){console.log("播放完毕")})},submit:function(t){var a=this;console.log("data",t);var e={};e.breakDownId=t.id,1==t.handleStatus?!this.isdel||1!=this.radio&&2!=this.radio?this.isdel||1!=this.radio?this.isdel||2!=this.radio||(e.handleStatus=5):e.handleStatus=4:e.handleStatus=3:4==t.handleStatus?this.isdel?e.handleStatus=3:e.handleStatus=4:5==t.handleStatus&&(this.isdel?e.handleStatus=3:e.handleStatus=5),e.solutionWay=this.radio,e.solutionRemark=t.solutionRemark,console.log("dddddddddd",e),this.$axios.put(this.$api.UpdateBreakDownInfo,e).then(function(t){console.log("提交成功",t),a.$refs.basedialog.dialogVisible=!1,a.tableDataMethod()})},detailsMethod:function(t){var a=this;console.log("breakDownId",t);var s=this;s.detailsData_BreakDownId=t,this.$axios({method:"get",url:s.$api.GetBreakDownInfo,params:{breakDownId:t}}).then(function(t){if(console.log("详情请求",t),s.detailsData_creationTime=t.data.result.creationTime,s.detailsData_userName=t.data.result.userName,s.detailsData_phone=t.data.result.userPhone,t.data.result.problemRemark?(s.detailsData_problemRemakeType=1,s.detailsData_remakeText=t.data.result.problemRemark):t.data.result.problemVoiceUrl?(s.detailsData_problemRemakeType=2,a.Duration=t.data.result.voiceLength):s.detailsData_problemRemakeType=0,2==t.data.result.problemRemakeType){var l=""+a.$URL+t.data.result.problemVoiceUrl;console.log(l);var n=e("/y4m");a.amr=new n,a.amr.initWithUrl(l).then(function(){})}if(s.detailsData_remark=t.data.result.solutionRemark,t.data.result.patrolPhotosPath){var o=!0,r=!1,d=void 0;try{for(var u,c=i()(t.data.result.patrolPhotosPath);!(o=(u=c.next()).done);o=!0){var p=u.value;p=""+a.$URL+p}}catch(t){r=!0,d=t}finally{try{!o&&c.return&&c.return()}finally{if(r)throw d}}s.detailsData_patrolPhotosPath=t.data.result.patrolPhotosPath}s.detailsData_solutionTime=t.data.result.solutionTime,2==t.data.result.handleStatus?s.form.status="未解决":3==t.data.result.handleStatus?s.form.status="已解决":1==t.data.result.handleStatus&&(s.form.status="未解决"),1==t.data.result.solutionWay?s.form.way="自行处理":2==t.data.result.solutionWay?s.form.way="维保叫修":0==t.data.result.solutionWay&&(s.form.way="自行处理"),s.form.desc=t.data.result.solutionRemark}).catch(function(t){console.log("详情请求失败",t)})}}},u={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"facilityFailure"},[s("div",{staticClass:"topStatus"},t._l(t.buttonarr,function(a){return s("el-button",{key:a.text,attrs:{round:"",plain:"",type:a.type},on:{click:function(e){return t.screen(a.text)}}},[t.screensign==a.text?s("i",{staticClass:"el-icon-check  el-icon--right"}):t._e(),t._v("\n            "+t._s(a.text)+"\n        ")])}),1),t._v(" "),"维保处理中"==t.screensign?s("div",{staticClass:"radioBox"},[s("el-radio-group",{on:{change:t.radioChange},model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[s("el-radio",{attrs:{label:6,border:""},model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[t._v("处理完成待确认")]),t._v(" "),s("el-radio",{attrs:{label:5,border:""},model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[t._v("已派单")])],1)],1):t._e(),t._v(" "),s("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:t.tableThead,tableData:t.tableData,totalCount:t.totalCount,pageSize:10,specailText:t.specailText},on:{pageChange:t.prev_next,showdetails:t.showdetails}}),t._v(" "),s("baseDialog",{ref:"basedialog",attrs:{title:t.title}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"basedialog",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("div",{staticClass:"left bg"},[s("p",{staticClass:"top"}),t._v(" "),s("div",{staticClass:"pd"},[s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("发现时间：")]),t._v("\n                        "+t._s(t.detailsData.creationTime)+"\n                    ")]),t._v(" "),4==t.detailsData.handleStatus||5==t.detailsData.handleStatus?s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("派单时间：")]),t._v("\n                        "+t._s(t.detailsData.dispatchTime)+"\n                    ")]):t._e(),t._v(" "),s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("问题来源：")]),t._v(" "),0==t.detailsData.source?s("span",[t._v("未指定")]):t._e(),t._v(" "),1==t.detailsData.source?s("span",[t._v("值班")]):t._e(),t._v(" "),2==t.detailsData.source?s("span",[t._v("巡查")]):t._e(),t._v(" "),3==t.detailsData.source?s("span",[t._v("物联终端")]):t._e()]),t._v(" "),s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("问题提交人：")]),t._v("\n                        "+t._s(t.detailsData.userName)+"（"+t._s(t.detailsData.userPhone)+"）\n                    ")]),t._v(" "),s("div",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("问题描述：")]),t._v(" "),t.detailsData.problemVoiceUrl?s("p",{staticClass:"voicebox",on:{click:t.playVioce}},[s("span",[t._v(t._s(t.detailsData.voiceLength)+'"')]),t._v(" "),s("img",{attrs:{src:e("FEo8"),alt:""}})]):t._e()]),t._v(" "),t.detailsData.problemRemark?s("p",{staticClass:"line"},[t._v("\n                            "+t._s(t.detailsData.problemRemark)+"\n                    ")]):t._e(),t._v(" "),t.detailsData.patrolPhotosPath?s("div",{staticClass:"imgBox"},[s("viewer",{staticClass:"viewer",attrs:{images:t.detailsData.patrolPhotosPath}},[t._l(t.detailsData.patrolPhotosPath,function(t,a){return s("img",{key:a,staticStyle:{width:"100px",height:"100px"},attrs:{src:t,fit:"cover"}})}),s("img")],2)],1):t._e()])]),t._v(" "),3!=t.detailsData.handleStatus?s("div",{staticClass:"right bg"},[s("p",{staticClass:"top"}),t._v(" "),s("div",{staticClass:"pd"},[s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("问题处理：")])]),t._v(" "),s("p",{staticClass:"line",staticStyle:{"justify-content":"space-between"}},[s("span",[t._v("是否已解决")]),t._v(" "),s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#cfcfcf"},model:{value:t.isdel,callback:function(a){t.isdel=a},expression:"isdel"}})],1),t._v(" "),1==t.detailsData.handleStatus?s("p",{staticClass:"line display_cloum"},[s("span",{staticClass:"line_title"},[t._v("问题处理途径：")]),t._v(" "),s("el-radio-group",{model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[s("el-radio",{attrs:{label:1}},[t._v("自行处理")]),t._v(" "),s("el-radio",{attrs:{label:2}},[t._v("维保叫修")])],1)],1):t._e(),t._v(" "),4==t.detailsData.handleStatus?s("p",{staticClass:"line",staticStyle:{"justify-content":"space-between"}},[s("span",[t._v("问题处理途径：")]),t._v(" "),s("span",[t._v("自行处理")])]):t._e(),t._v(" "),5==t.detailsData.handleStatus?s("p",{staticClass:"line",staticStyle:{"justify-content":"space-between"}},[s("span",[t._v("问题处理途径：")]),t._v(" "),s("span",[t._v("维保叫修（处理中）")])]):t._e(),t._v(" "),s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("备注：")])]),t._v(" "),s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.detailsData.solutionRemark,callback:function(a){t.$set(t.detailsData,"solutionRemark",a)},expression:"detailsData.solutionRemark"}}),t._v(" "),t.isdel||4==t.detailsData.handleStatus||5==t.detailsData.handleStatus?s("el-button",{on:{click:function(a){return t.submit(t.detailsData)}}},[t._v("提交")]):t._e(),t._v(" "),t.isdel||1!=t.detailsData.handleStatus?t._e():s("el-button",{on:{click:function(a){return t.submit(t.detailsData)}}},[t._v("派单")])],1)]):s("div",{staticClass:"right bg"},[s("p",{staticClass:"top"}),t._v(" "),s("div",{staticClass:"pd"},[s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("解决时间：")]),t._v("\n                        "+t._s(t.detailsData.solutionTime)+"\n                    ")]),t._v(" "),s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("处理途径：")]),t._v("\n                        "+t._s(t.detailsData.solutionWay)+"\n                    ")]),t._v(" "),s("p",{staticClass:"line"},[s("span",{staticClass:"line_title"},[t._v("备注说明：")])]),t._v(" "),s("p",{staticClass:"line"},[t._v("\n                         "+t._s(t.detailsData.solutionRemark)+"\n                    ")])])])])])],1)},staticRenderFns:[]};var c=e("VU/8")(d,u,!1,function(t){e("xe+q")},null,null);a.default=c.exports},bOdI:function(t,a,e){"use strict";a.__esModule=!0;var s,i=e("C4MV"),l=(s=i)&&s.__esModule?s:{default:s};a.default=function(t,a,e){return a in t?(0,l.default)(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}},mClu:function(t,a,e){var s=e("kM2E");s(s.S+s.F*!e("+E39"),"Object",{defineProperty:e("evD5").f})},"xe+q":function(t,a){}});
//# sourceMappingURL=9.e5306ffe256110351952.js.map