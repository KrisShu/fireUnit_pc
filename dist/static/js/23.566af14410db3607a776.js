webpackJsonp([23],{DKB8:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("mvHQ"),a=i.n(o),r=i("Nn1j"),n=i("HR9O"),s=i("9mCZ"),l={components:{baseTable:r.a,baseDialog:n.a,baseUploadImg:s.a},data:function(){return{loading:!1,isadd:!1,tableThead:[{prop:"name",name:"姓名"},{prop:"rolelist",name:"职务"},{prop:"account",name:"手机"},{prop:"qualification",name:"职务资格"},{prop:"qualificationNumber",name:"证书编号"},{prop:"qualificationValidity",name:"证书有效期"},{name:"操作",width:"200px"}],tableData:[],rules:{name:[{required:!0,message:"请填写姓名",trigger:"blur"}],account:[{required:!0,message:"请填写手机号",trigger:"blur"}]},PractitionersForm:{},joboptions:["消防管理员","值班员","巡查员"]}},created:function(){this.GetFireUnitPeople()},methods:{GetFireUnitPeople:function(){var e=this;this.loading=!0;var t=localStorage.getItem("userId");this.$axios.get(this.$api.GetFireUnitPeople,{params:{AccountID:t}}).then(function(t){console.log("获取从业人员shuju",t),e.loading=!1,e.tableData=t.data.result}).catch(function(e){console.log("获取从业人员失败",e)})},showdetails:function(e){this.$refs.basedialog.dialogVisible=!0;var t=a()(e);this.PractitionersForm=JSON.parse(t)},deleteInfo:function(e){var t=this;console.log("要删除的",e);var i=e.id;i!=localStorage.getItem("userId")?this.$axios.delete(this.$api.DeleteUser,{params:{UserId:i}}).then(function(e){console.log("删除成功",e),e.data.result.success&&(t.$message({message:"删除工作人员成功",type:"warning"}),t.GetFireUnitPeople())}).catch(function(e){console.log("删除失败",e)}):this.$message({message:"该人员不能删除",type:"error"})},addNew:function(){this.$refs.basedialog.dialogVisible=!0,this.PractitionersForm={},this.PractitionersForm.fireUnitInfoID=localStorage.getItem("fireUnitID")},submitForm:function(){var e=this;this.$refs.PractitionersForm.validate(function(t){if(t){var i=e.PractitionersForm.id?e.$axios.put(e.$api.UpdateUserInfo,e.PractitionersForm):e.$axios.post(e.$api.AddUser,e.PractitionersForm);console.log(e.PractitionersForm.id,e.PractitionersForm),e.$confirm("确定"+(e.PractitionersForm.id?"修改":"新增")+"人员吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("打印",e.PractitionersForm),i.then(function(t){console.log("修改人员信息成功",t),t.data.result.success&&(e.$refs.basedialog.dialogVisible=!1,e.$message((e.PractitionersForm.id?"修改":"新增")+"人员成功"),e.GetFireUnitPeople())}).catch(function(t){console.log("修改人员信息失败",t),e.$message({message:"修改人员失败",type:"warning"})})}).catch(function(){})}})},cancel:function(e){e?this.$refs.basedialog.dialogVisible=!1:this.PractitionersForm={}},Prev_next:function(e){},closeDialog:function(){this.$refs.PractitionersForm.resetFields()}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"firePractitionersBox"},[i("div",{staticClass:"top_box"},[i("el-button",{on:{click:e.addNew}},[e._v("新增")])],1),e._v(" "),i("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.tableThead,tableData:e.tableData},on:{showdetails:e.showdetails,deleteInfo:e.deleteInfo,pageChange:e.Prev_next}}),e._v(" "),i("baseDialog",{ref:"basedialog",attrs:{title:"从业人员"},on:{closeDialog:e.closeDialog}},[i("div",{staticStyle:{width:"100%"},attrs:{slot:"soltContent"},slot:"soltContent"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:12}},[i("el-form",{ref:"PractitionersForm",staticClass:"demo-ruleForm",attrs:{model:e.PractitionersForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{staticClass:"must_label",attrs:{label:"姓名",prop:"name"}},[i("el-input",{model:{value:e.PractitionersForm.name,callback:function(t){e.$set(e.PractitionersForm,"name",t)},expression:"PractitionersForm.name"}})],1),e._v(" "),i("el-form-item",{staticClass:"must_label",attrs:{label:"职务",prop:"rolelist"}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择职务"},model:{value:e.PractitionersForm.rolelist,callback:function(t){e.$set(e.PractitionersForm,"rolelist",t)},expression:"PractitionersForm.rolelist"}},e._l(e.joboptions,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-form-item",{staticClass:"must_label",attrs:{label:"手机号",prop:"account"}},[i("el-input",{model:{value:e.PractitionersForm.account,callback:function(t){e.$set(e.PractitionersForm,"account",t)},expression:"PractitionersForm.account"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"职业资格",prop:"qualifications"}},[i("el-input",{model:{value:e.PractitionersForm.qualification,callback:function(t){e.$set(e.PractitionersForm,"qualification",t)},expression:"PractitionersForm.qualification"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"证书编号",prop:"certificateNumber"}},[i("el-input",{model:{value:e.PractitionersForm.qualificationNumber,callback:function(t){e.$set(e.PractitionersForm,"qualificationNumber",t)},expression:"PractitionersForm.qualificationNumber"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"证书有效期",prop:"qualificationValidity"}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.PractitionersForm.qualificationValidity,callback:function(t){e.$set(e.PractitionersForm,"qualificationValidity",t)},expression:"PractitionersForm.qualificationValidity"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")]),e._v(" "),i("el-button",{staticClass:"cancel",on:{click:function(t){return e.cancel(e.PractitionersForm.id)}}},[e._v("取消")])],1)],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("div",[i("baseUploadImg",{model:{value:e.PractitionersForm.photo,callback:function(t){e.$set(e.PractitionersForm,"photo",t)},expression:"PractitionersForm.photo"}})],1)])],1)],1)])],1)},staticRenderFns:[]};var m=i("VU/8")(l,c,!1,function(e){i("Km/0")},null,null);t.default=m.exports},"Km/0":function(e,t){}});
//# sourceMappingURL=23.566af14410db3607a776.js.map