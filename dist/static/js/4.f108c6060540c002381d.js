webpackJsonp([4],{"1alW":function(e,t,a){var r=a("kM2E");r(r.S,"Number",{isInteger:a("AKgy")})},AKgy:function(e,t,a){var r=a("EqjI"),o=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&o(e)===e}},OMJi:function(e,t,a){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),a={},r=0;r<t.length;r++)a[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return a},o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(l(arguments[a]));return t.join(" ")}a=1;for(var r=arguments,i=r.length,n=String(e).replace(o,function(e){if("%%"===e)return"%";if(a>=i)return e;switch(e){case"%s":return String(r[a++]);case"%d":return Number(r[a++]);case"%j":try{return JSON.stringify(r[a++])}catch(e){return"[Circular]"}default:return e}}),s=r[a];a<i;s=r[++a])g(s)||!_(s)?n+=" "+s:n+=" "+l(s);return n},t.deprecate=function(a,r){if(void 0!==e&&!0===e.noDeprecation)return a;if(void 0===e)return function(){return t.deprecate(a,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return a.apply(this,arguments)}};var i,n={};function l(e,a){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(a)?r.showHidden=a:a&&t._extend(r,a),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),u(r,e,r.depth)}function s(e,t){var a=l.styles[t];return a?"["+l.colors[a][0]+"m"+e+"["+l.colors[a][1]+"m":e}function c(e,t){return e}function u(e,a,r){if(e.customInspect&&a&&k(a.inspect)&&a.inspect!==t.inspect&&(!a.constructor||a.constructor.prototype!==a)){var o=a.inspect(r,e);return v(o)||(o=u(e,o,r)),o}var i=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(v(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(a,"string")}if(h(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(g(t))return e.stylize("null","null")}(e,a);if(i)return i;var n=Object.keys(a),l=function(e){var t={};return e.forEach(function(e,a){t[e]=!0}),t}(n);if(e.showHidden&&(n=Object.getOwnPropertyNames(a)),w(a)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return m(a);if(0===n.length){if(k(a)){var s=a.name?": "+a.name:"";return e.stylize("[Function"+s+"]","special")}if(y(a))return e.stylize(RegExp.prototype.toString.call(a),"regexp");if(D(a))return e.stylize(Date.prototype.toString.call(a),"date");if(w(a))return m(a)}var c,_="",A=!1,x=["{","}"];(f(a)&&(A=!0,x=["[","]"]),k(a))&&(_=" [Function"+(a.name?": "+a.name:"")+"]");return y(a)&&(_=" "+RegExp.prototype.toString.call(a)),D(a)&&(_=" "+Date.prototype.toUTCString.call(a)),w(a)&&(_=" "+m(a)),0!==n.length||A&&0!=a.length?r<0?y(a)?e.stylize(RegExp.prototype.toString.call(a),"regexp"):e.stylize("[Object]","special"):(e.seen.push(a),c=A?function(e,t,a,r,o){for(var i=[],n=0,l=t.length;n<l;++n)C(t,String(n))?i.push(p(e,t,a,r,String(n),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,a,r,o,!0))}),i}(e,a,r,l,n):n.map(function(t){return p(e,a,r,l,t,A)}),e.seen.pop(),function(e,t,a){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1];return a[0]+t+" "+e.join(", ")+" "+a[1]}(c,_,x)):x[0]+_+x[1]}function m(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,r,o,i){var n,l,s;if((s=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?l=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(l=e.stylize("[Setter]","special")),C(r,o)||(n="["+o+"]"),l||(e.seen.indexOf(s.value)<0?(l=g(a)?u(e,s.value,null):u(e,s.value,a-1)).indexOf("\n")>-1&&(l=i?l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+l.split("\n").map(function(e){return"   "+e}).join("\n")):l=e.stylize("[Circular]","special")),b(n)){if(i&&o.match(/^\d+$/))return l;(n=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+l}function f(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function g(e){return null===e}function h(e){return"number"==typeof e}function v(e){return"string"==typeof e}function b(e){return void 0===e}function y(e){return _(e)&&"[object RegExp]"===A(e)}function _(e){return"object"==typeof e&&null!==e}function D(e){return _(e)&&"[object Date]"===A(e)}function w(e){return _(e)&&("[object Error]"===A(e)||e instanceof Error)}function k(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(a){if(b(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),a=a.toUpperCase(),!n[a])if(new RegExp("\\b"+a+"\\b","i").test(i)){var r=e.pid;n[a]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",a,r,e)}}else n[a]=function(){};return n[a]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=d,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=h,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=y,t.isObject=_,t.isDate=D,t.isError=w,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=a("fC4T");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,a;console.log("%s - %s",(e=new Date,a=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":"),[e.getDate(),F[e.getMonth()],a].join(" ")),t.format.apply(t,arguments))},t.inherits=a("ONRY"),t._extend=function(e,t){if(!t||!_(t))return e;for(var a=Object.keys(t),r=a.length;r--;)e[a[r]]=t[a[r]];return e};var $="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function S(e,t){if(!e){var a=new Error("Promise was rejected with a falsy value");a.reason=e,e=a}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if($&&e[$]){var t;if("function"!=typeof(t=e[$]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,a,r=new Promise(function(e,r){t=e,a=r}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(e,r){e?a(e):t(r)});try{e.apply(this,o)}catch(e){a(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),$&&Object.defineProperty(t,$,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=$,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function a(){for(var a=[],r=0;r<arguments.length;r++)a.push(arguments[r]);var o=a.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,n=function(){return o.apply(i,arguments)};t.apply(this,a).then(function(t){e.nextTick(n,null,t)},function(t){e.nextTick(S,t,n)})}return Object.setPrototypeOf(a,Object.getPrototypeOf(t)),Object.defineProperties(a,r(t)),a}}).call(t,a("W2nU"))},ONRY:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},"RRo+":function(e,t,a){e.exports={default:a("c45H"),__esModule:!0}},YSze:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),o=a.n(r),i=a("BO1k"),n=a.n(i),l=a("RRo+"),s=a.n(l),c=a("Nn1j"),u=a("HR9O"),m=(a("OMJi"),{components:{baseTable:c.a,baseDialog:u.a},data:function(){return{page:{FireUnitId:localStorage.getItem("fireUnitID"),SkipCount:0,MaxResultCount:10},totalCount:0,buildList:[],DeviceTypes:[],DeviceProtocols:[],Baudrates:["1200","2400","4800","9600","14400","19200","28800","38400","57600","115200"],types:["232","485"],tableThead:[{name:"设备编号",prop:"deviceSn"},{name:"所在建筑",prop:"fireUnitArchitectureName"},{name:"状态",prop:"state"},{name:"联网部件数量",prop:"netDetectorNum"},{name:"故障部件数量",prop:"faultDetectorNum"},{name:"部件故障率",prop:"detectorFaultRate"},{name:"30天火警数量",prop:"alarmNum30Day"},{name:"高频部件数量",prop:"highAlarmDetectorNum"},{name:"操作",width:"200px"}],tableData:[],equmentform:{enableAlarm:[],enableFault:[]},equmentform1:{deviceModel:"TSJ-CS10",enableAlarm:["云端报警"],enableFault:["云端报警"],baudRate:"9600",comType:"232"},rules:{deviceModel:[{required:!0,message:"选择设备型号",trigger:"change"}],deviceSn:[{required:!0,message:"请填写设备编号",trigger:"blur"}],netDetectorNum:[{validator:function(e,t,a){setTimeout(function(){s()(t)?a():a(new Error("请输入数字值"))},1e3)},trigger:"blur"}]},PortParam:{},networkFormrules:{identify:[{required:!0,message:"请填写部件地址",trigger:"blur"}]},networkThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"安装位置",prop:"location"},{name:"状态",prop:"state"},{name:"操作"}],networkData:[],networkForm:{},FireAlarmDetectorTypes:[],fireUnitArchitecturefloors:[],networktotalCount:0,networkPage:{SkipCount:0,MaxResultCount:5,current:1},fileList:[],FaultPage:{SkipCount:0,MaxResultCount:5,current:1},faultTotalCount:0,faultThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"故障描述",prop:"faultContent"},{name:"故障时间",prop:"faultTime"}],faultData:[],alarm30_high_title:"火警联网系统30天火警记录",Alarm30Day_highPage:{SkipCount:0,MaxResultCount:5,current:1},Alarm30Day_highTotal:0,Alarm30Day_highThead:[],Alarm30Day_highData:[],Alarm30Day_toptips_fireUnitArchitectureName:"",Alarm30Day_toptips_deviceSn:"",highThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"平均每天报警",prop:"alarmNum"}],Alarm30DayThead:[{name:"部件地址",prop:"identify"},{name:"部件类型",prop:"detectorTypeName"},{name:"楼层",prop:"fireUnitArchitectureFloorName"},{name:"安装位置",prop:"location"},{name:"报警时间",prop:"alarmTime"}],loading:!1}},created:function(){this.GetListByFireUnitId(),this.GetFireAlarmDeviceList(),this.GetFireAlarmDeviceModels()},methods:{GetFireAlarmDeviceList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmDeviceList,{params:this.page}).then(function(t){if(console.log("GetFireAlarmDeviceList",t),e.loading=!1,t.data.result.totalCount){var a=t.data.result;e.tableData=a.items,e.totalCount=a.totalCount,0==t.data.result.items.length&&t.data.result.totalCount>0&&(e.page.SkipCount=0,e.GetFireAlarmDeviceList())}}).catch(function(e){console.log("err",e)})},AlarmDeviceList_prev_next:function(e){this.page.SkipCount=(e-1)*this.page.MaxResultCount,this.GetFireAlarmDeviceList()},GetListByFireUnitId:function(){var e=this,t=localStorage.getItem("fireUnitID");this.$axios.get(this.$api.GetListByFireUnitId,{params:{fireunitId:t}}).then(function(t){if(console.log("获取到的建筑",t),t.data.result.length>0){var a=[],r=!0,o=!1,i=void 0;try{for(var l,s=n()(t.data.result);!(r=(l=s.next()).done);r=!0){var c=l.value;a.push({name:c.name,id:c.id})}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}console.log("arrlist",a),e.buildList=a}}).catch(function(e){console.log("获取到的建筑error",e)})},GetFireAlarmDeviceModels:function(){var e=this;this.$axios.all([this.$axios.get(this.$api.GetFireAlarmDeviceModels,{params:{}}),this.$axios.get(this.$api.GetFireAlarmDeviceProtocols,{params:{}})]).then(this.$axios.spread(function(t,a){console.log("data1",t),console.log("data2",a),t.data.result.length>0&&(e.DeviceTypes=t.data.result),a.data.result.length>0&&(e.DeviceProtocols=a.data.result)})).catch(this.$axios.spread(function(e,t){console.log("data1",e),console.log("data2",t)}))},add_update_equment:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.equmentform.fireUnitId=localStorage.getItem("fireUnitID"),console.log("this.equmentform",e.equmentform),(e.equmentform.deviceId?e.$axios.put(e.$api.UpdateFireAlarmDevice,e.equmentform):e.$axios.post(e.$api.AddFireAlarmDevice,e.equmentform)).then(function(t){console.log("新增设施成功",t),t.data.success&&(e.$message.success((e.equmentform.deviceId?"修改":"新增")+"联网设施成功"),e.$refs.baseDialog.dialogVisible=!1,e.GetFireAlarmDeviceList())}).catch(function(e){console.log("新增或修改联网设施失败",e)}))})},cancel:function(e){if(e)this.$refs.baseDialog.dialogVisible=!1;else{var t=o()(this.equmentform1);this.equmentform=JSON.parse(t)}},addNew:function(){this.$refs.baseDialog.dialogVisible=!0;var e=o()(this.equmentform1);this.equmentform=JSON.parse(e);var t=localStorage.getItem("contractPhone");this.$set(this.equmentform,"smsPhones",t)},closeDialog:function(e){"联网部件信息"==e?this.$refs.network_detail.resetFields():"消防设备信息"==e&&this.$refs.form.resetFields()},deleteTotal:function(e){var t=this;console.log(e);var a=e.deviceId;this.$axios.delete(this.$api.DeleteFireAlarmDevice,{params:{DeviceId:a}}).then(function(e){console.log("删除成功",e),e.data.success&&(t.$message({message:"删除该条数据成功",type:"success"}),t.GetFireAlarmDeviceList())}).catch(function(e){console.log("删除是被",e)})},showdetails:function(e){var t=this;this.$refs.baseDialog.dialogVisible=!0;var a=e.deviceId;this.$axios.all([this.$axios.get(this.$api.GetSerialPortParam,{params:{DeviceId:a}}),this.$axios.get(this.$api.GetFireAlarmDevice,{params:{DeviceId:a}})]).then(this.$axios.spread(function(e,a){if(console.log("获取串口参数成功",e),e.data.success&&(t.PortParam=e.data.result),console.log("获取联网设施详情",a),a.data.success){var r=o()(a.data.result);t.equmentform=JSON.parse(r)}}))},refreshPortParam:function(){var e=this;this.loading=!0;var t=this.equmentform.deviceId;this.$axios.get(this.$api.GetSerialPortParam,{params:{DeviceId:t}}).then(function(t){console.log("刷新串口参数成功",t),t.data.success&&(e.loading=!1,e.PortParam=t.data.result,e.$message({message:"串口参数刷新成功",type:"success"}))}).catch(function(e){console.log("刷新串口参数失败",e)})},getdialogContent:function(e,t){console.log("name",t,e),"故障部件数量"==t?(this.$refs.faultListDialog.dialogVisible=!0,this.FaultPage.fireAlarmDeviceId=e.deviceId,this.GetFireAlarmFaultDetectorList()):"30天火警数量"==t?(this.alarm30_high_title="火警联网系统30天火警记录",this.$refs.fireRecord_highFrequencyDialog.dialogVisible=!0,this.Alarm30Day_highPage.fireAlarmDeviceId=e.deviceId,this.Alarm30Day_toptips_deviceSn=e.deviceSn,this.Alarm30Day_toptips_fireUnitArchitectureName=e.fireUnitArchitectureName,this.Alarm30Day_highThead=this.Alarm30DayThead,this.Alarm30Day_highPage.SkipCount=0,this.Alarm30Day_highPage.current=1,this.GetFireAlarm30DayList(this.Alarm30Day_highPage)):"高频部件数量"==t&&(this.alarm30_high_title="火警联网高频报警数量",this.Alarm30Day_highThead=this.highThead,this.Alarm30Day_highPage.fireAlarmDeviceId=e.deviceId,this.Alarm30Day_toptips_deviceSn=e.deviceSn,this.Alarm30Day_toptips_fireUnitArchitectureName=e.fireUnitArchitectureName,this.Alarm30Day_highPage.SkipCount=0,this.Alarm30Day_highPage.current=1,console.log("Alarm30Day_highPage",this.Alarm30Day_highPage),this.$refs.fireRecord_highFrequencyDialog.dialogVisible=!0,this.GetFireAlarmHighList(this.Alarm30Day_highPage))},GetFireAlarmFaultDetectorList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmFaultDetectorList,{params:this.FaultPage}).then(function(t){e.loading=!1,console.log("打印获取故障设施列表",t);var a=t.data.result;e.faultData=a.items,e.faultTotalCount=a.totalCount}).catch(function(e){console.log("打印获取故障设施列表失败",e)})},fault_next_prevPage:function(e){this.FaultPage.SkipCount=(e-1)*this.FaultPage.MaxResultCount,this.FaultPage.current=e,this.GetFireAlarmFaultDetectorList(this.FaultPage)},GetFireAlarm30DayList:function(e){var t=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarm30DayList,{params:e}).then(function(e){console.log("获取30天火警数量成功",e),t.loading=!1;var a=e.data.result;t.Alarm30Day_highData=a.items,t.Alarm30Day_highTotal=a.totalCount;var r=!0,o=!1,i=void 0;try{for(var l,s=n()(t.Alarm30Day_highData);!(r=(l=s.next()).done);r=!0){var c=l.value;c.alarmTime=t.deal(c.alarmTime)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}).catch(function(e){console.log("获取30天火警数量失败",e)})},deal:function(e){var t=e.split("T"),a=t[1].split(".");return t[0]+" "+a[0]},GetFireAlarmHighList:function(e){var t=this;this.loading=!0,this.$axios.get(this.$api.GetFireAlarmHighList,{params:e}).then(function(e){console.log("获取高频报警数量成功",e),t.loading=!1;var a=e.data.result;t.Alarm30Day_highData=a.items,t.Alarm30Day_highTotal=a.totalCount}).catch(function(e){console.log("获取高频报警数量失败",e)})},next_prevPage:function(e){console.log("page",e),this.Alarm30Day_highPage.current=e,this.Alarm30Day_highPage.SkipCount=(e-1)*this.Alarm30Day_highPage.MaxResultCount,console.log("this.Alarm30Day_highPage",this.Alarm30Day_highPage),"火警联网系统30天火警记录"==this.alarm30_high_title?this.GetFireAlarm30DayList(this.Alarm30Day_highPage):"火警联网高频报警数量"==this.alarm30_high_title&&this.GetFireAlarmHighList(this.Alarm30Day_highPage)},getnetwork:function(e){console.log("getnetworkTable",e),this.networkForm.fireUnitArchitectureName=e.fireUnitArchitectureName;var t={};t.fireUnitArchitectureName=e.fireUnitArchitectureName,t.fireUnitArchitectureId=e.fireUnitArchitectureId,t.deviceSn=e.deviceSn,t.fireAlarmDeviceId=e.fireAlarmDeviceId,localStorage.setItem("networkForm",o()(t)),this.$refs.networkDialog.dialogVisible=!0,this.networkPage.DeviceSn=e.deviceSn,this.networkPage.fireAlarmDeviceId=e.deviceId,this.networkPage.SkipCount=0,this.networkPage.current=1,this.GetDeviceDetectorList(),this.getneteorktypes_build(t)},GetDeviceDetectorList:function(){var e=this;this.loading=!0,this.$axios.get(this.$api.GetDeviceDetectorList,{params:this.networkPage}).then(function(t){console.log("获取该条联网部件",t),e.loading=!1;var a=t.data.result;e.networkData=a.items,e.networktotalCount=a.totalCount,0==t.data.result.items.length&&t.data.result.totalCount>0&&(e.networkPage.SkipCount=0,e.GetDeviceDetectorList())}).catch(function(e){console.log("获取该条联网部件失败",e)})},network_prev_next:function(e){this.networkPage.SkipCount=(e-1)*this.networkPage.MaxResultCount,console.log("this.networkPage",this.networkPage),this.networkPage.current=e,this.GetDeviceDetectorList()},addNetworkcomponents:function(){this.networkForm={};var e=JSON.parse(localStorage.getItem("networkForm"));this.networkForm.fireUnitArchitectureName=e.fireUnitArchitectureName,this.networkForm.fireUnitArchitectureId=e.fireUnitArchitectureId,this.networkForm.deviceSn=e.deviceSn,this.$refs.network_detailDialog.dialogVisible=!0},getneteorktypes_build:function(e){var t=this;console.log("获取联网部件的楼层和部件类型");var a=localStorage.getItem("fireUnitID");this.$axios.all([this.$axios.get(this.$api.GetFireAlarmDetectorTypes,{params:{}}),this.$axios.get(this.$api.GetListByFireUnitId,{params:{fireunitId:a}})]).then(this.$axios.spread(function(a,r){if(console.log("获取部件类型",a),t.FireAlarmDetectorTypes=a.data.result,console.log("获取所在建筑 的楼层",r),console.log("名字相等",e.fireUnitArchitectureName),r.data.result.length>0){var o=!0,i=!1,l=void 0;try{for(var s,c=n()(r.data.result);!(o=(s=c.next()).done);o=!0){var u=s.value;e.fireUnitArchitectureName==u.name&&(t.fireUnitArchitecturefloors=u.floors)}}catch(e){i=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw l}}}}))},add_updatenetwork:function(){var e=this;console.log(this.networkForm),this.$refs.network_detail.validate(function(t){t&&(e.networkForm.detectorId?e.$axios.put(e.$api.UpdateFireAlarmDetector,e.networkForm):e.$axios.post(e.$api.AddFireAlarmDetector,e.networkForm)).then(function(t){console.log("新增或修改联网部件成功",t),t.data.success&&(e.$refs.network_detailDialog.dialogVisible=!1,e.$message.success((e.networkForm.detectorId?"修改":"新增")+"联网部件成功"),e.GetDeviceDetectorList(JSON.parse(localStorage.getItem("networkForm")).deviceSn))}).catch(function(e){console.log("新增或修改联网部件失败",e)})})},network_cancel:function(){},showdetails_network:function(e){console.log("联网部件详情",e),this.$refs.network_detailDialog.dialogVisible=!0,this.networkForm=e},DeleteDetector:function(e){var t=this,a=e.detectorId;this.$axios.delete(this.$api.DeleteDetector,{params:{DetectorId:a}}).then(function(e){console.log("删除",e),t.$message({message:"删除该条数据成功",type:"success"}),t.GetDeviceDetectorList(JSON.parse(localStorage.getItem("networkForm")).deviceSn)})},Import:function(){this.$refs.network_importDialog.dialogVisible=!0},download:function(){var e=document.createElement("a");e.style.display="none",e.href="http://futest.sctsjkj.com/template/消防火警联网部件设施数据表.xlsx",e.click()},handleExceed:function(){this.$notify({title:"警告",message:"只能上传一个文件哦!,若需要上传其他文件请先移除已选择的文件",type:"warning"})},uploadFile:function(e){var t=this,a=new FormData;a.append("FireAlarmDeviceSn",this.networkPage.DeviceSn),a.append("file",e.file),this.$axios.post(this.$api.ImportFireAlarmDetector,a).then(function(e){console.log("res",e),e.data.result.success?(t.$message({message:"导入数据成功!",type:"success"}),t.GetDeviceDetectorList()):t.$message({showClose:!0,message:"导入失败！"+e.data.result.failCause,type:"error",duration:"6000"}),t.fileList=[],t.$refs.network_importDialog.dialogVisible=!1}).catch(function(e){console.log("err",e)})},beforeAvatarUpload:function(e){var t="xls"===e.name.split(".")[1],a="xlsx"===e.name.split(".")[1];t||a||alert("上传模板只能是 xls、xlsx格式!")},submitUpload:function(){var e=this;this.$confirm("导入的方式会覆盖现有的记录, 是否继续?","导入数据",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$refs.upload.submit()}).catch(function(){})}}}),p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"firenetworkingBox"},[a("div",{staticClass:"top_tips"},[a("div",{staticClass:"tooltip"},[a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("div",{staticClass:"content"},[e._v("\n          高频报警部件是指近期频繁报警（近两天平均每天5次及以上报警）的终端探测部件"),a("br"),e._v("\n          应勘察频繁报警的终端探测器现场有无蒸汽、油气、粉尘等影响火灾探测器正常工作的环境存在，如有应设法排除。"),a("br"),e._v("\n          对于误报频繁而又无其他干扰影响正常工作的火灾探测器，应及时更换。\n        ")]),e._v(" "),a("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("什么是高频报警部件？")])],1)],1),e._v(" "),a("el-button",{on:{click:e.addNew}},[e._v("新增")])],1),e._v(" "),a("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.tableThead,tableData:e.tableData,ishownetworkBtn:!0,pageSize:10,totalCount:e.totalCount},on:{pageChange:e.AlarmDeviceList_prev_next,getnetwork:e.getnetwork,getdialogContent:e.getdialogContent,showdetails:e.showdetails,deleteInfo:e.deleteTotal}}),e._v(" "),a("baseDialog",{ref:"baseDialog",attrs:{title:"消防设备信息"},on:{closeDialog:e.closeDialog}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"formBox",attrs:{rules:e.rules,model:e.equmentform,"label-width":"80px"}},[a("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[a("el-col",{staticClass:"left_box",attrs:{span:4}},[a("div",{staticClass:"grid-content basetitle"},[e._v("基本")])]),e._v(" "),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"grid-content"},[a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备型号",prop:"deviceModel"}},[a("el-select",{attrs:{placeholder:"请选择设备型号"},model:{value:e.equmentform.deviceModel,callback:function(t){e.$set(e.equmentform,"deviceModel",t)},expression:"equmentform.deviceModel"}},e._l(e.DeviceTypes,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("p",{staticClass:"marginleft10"},[e._v("设备名称：火警联网设施")])])],1),e._v(" "),a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备编号",prop:"deviceSn"}},[a("el-input",{attrs:{placeholder:"设备编号"},model:{value:e.equmentform.deviceSn,callback:function(t){e.$set(e.equmentform,"deviceSn",t)},expression:"equmentform.deviceSn"}})],1)],1),e._v(" "),e.equmentform.deviceId?a("el-col",{attrs:{span:12}},["在线"==e.equmentform.state?a("p",{staticClass:"marginleft10"},[e._v("设备状态："),a("span",{staticClass:"green"},[e._v(e._s(e.equmentform.state))])]):e._e(),e._v(" "),"离线"==e.equmentform.state?a("p",{staticClass:"marginleft10"},[e._v("设备状态："),a("span",{staticClass:"red"},[e._v(e._s(e.equmentform.state))])]):e._e()]):e._e()],1)],1)])],1),e._v(" "),a("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[a("el-col",{staticClass:"left_box",attrs:{span:4}},[a("div",{staticClass:"grid-content basetitle"},[e._v("消防主机")])]),e._v(" "),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"grid-content"},[a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所在建筑",prop:"fireUnitArchitectureId"}},[a("el-select",{attrs:{disabled:!!e.equmentform.deviceId,placeholder:"请选择所在建筑"},model:{value:e.equmentform.fireUnitArchitectureId,callback:function(t){e.$set(e.equmentform,"fireUnitArchitectureId",t)},expression:"equmentform.fireUnitArchitectureId"}},e._l(e.buildList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{staticClass:"networkNum",attrs:{span:12}},[a("el-form-item",{attrs:{label:"品牌："}},[a("el-input",{attrs:{placeholder:"请输入品牌"},model:{value:e.equmentform.brand,callback:function(t){e.$set(e.equmentform,"brand",t)},expression:"equmentform.brand"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"通讯协议",prop:"protocol"}},[a("el-select",{attrs:{placeholder:"请选择通讯协议"},model:{value:e.equmentform.protocol,callback:function(t){e.$set(e.equmentform,"protocol",t)},expression:"equmentform.protocol"}},e._l(e.DeviceProtocols,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{staticClass:"networkNum",attrs:{span:12}},[a("el-form-item",{attrs:{label:"联网部件数量：",prop:"netDetectorNum"}},[a("el-input",{attrs:{placeholder:"请输入联网部件数量"},model:{value:e.equmentform.netDetectorNum,callback:function(t){e.$set(e.equmentform,"netDetectorNum",e._n(t))},expression:"equmentform.netDetectorNum"}})],1)],1)],1)],1)])],1),e._v(" "),a("el-row",{staticClass:"baseBox",attrs:{gutter:20}},[a("el-col",{staticClass:"left_box",attrs:{span:4}},[a("div",{staticClass:"grid-content basetitle"},[e._v("参数")])]),e._v(" "),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"grid-content"},[a("el-row",{staticClass:"pd20"},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"发现故障",prop:"Model"}},[a("el-checkbox-group",{model:{value:e.equmentform.enableFault,callback:function(t){e.$set(e.equmentform,"enableFault",t)},expression:"equmentform.enableFault"}},[a("el-checkbox",{attrs:{label:"云端报警"}}),e._v(" "),a("el-checkbox",{attrs:{label:"发送短信"}}),e._v(" "),a("el-checkbox",{attrs:{label:"发送开关量信号"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"pd20"},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"发现火警",prop:"Model"}},[a("el-checkbox-group",{model:{value:e.equmentform.enableAlarm,callback:function(t){e.$set(e.equmentform,"enableAlarm",t)},expression:"equmentform.enableAlarm"}},[a("el-checkbox",{attrs:{label:"云端报警"}}),e._v(" "),a("el-checkbox",{attrs:{label:"发送短信"}}),e._v(" "),a("el-checkbox",{attrs:{label:"发送开关量信号"}})],1)],1),e._v(" "),-1!=e.equmentform.enableAlarm.indexOf("发送短信")||-1!=e.equmentform.enableFault.indexOf("发送短信")?a("el-col",{staticClass:"smsPhones",attrs:{span:16}},[a("el-form-item",{attrs:{label:"接收手机"}},[a("el-input",{attrs:{placeholder:"请输入接收手机号码(输入多个时需要用英文逗号隔开)"},model:{value:e.equmentform.smsPhones,callback:function(t){e.$set(e.equmentform,"smsPhones",t)},expression:"equmentform.smsPhones"}})],1)],1):e._e()],1)],1),e._v(" "),a("div",[a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"串口参数",prop:"comType"}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.equmentform.comType,callback:function(t){e.$set(e.equmentform,"comType",t)},expression:"equmentform.comType"}},e._l(e.types,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"波特率",prop:"baudRate"}},[a("el-select",{attrs:{placeholder:"请选择波特率"},model:{value:e.equmentform.baudRate,callback:function(t){e.$set(e.equmentform,"baudRate",t)},expression:"equmentform.baudRate"}},e._l(e.Baudrates,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"pd20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"通讯方式",prop:"netComm"}},[a("el-select",{attrs:{placeholder:"请选择通讯方式"},model:{value:e.equmentform.netComm,callback:function(t){e.$set(e.equmentform,"netComm",t)},expression:"equmentform.netComm"}},[a("el-option",{attrs:{label:"以太网",value:"以太网"}}),e._v(" "),a("el-option",{attrs:{label:"WIFI",value:"WIFI"}}),e._v(" "),a("el-option",{attrs:{label:"NB-IOT",value:"NB-IOT"}}),e._v(" "),a("el-option",{attrs:{label:"4G",value:"4G"}})],1)],1)],1)],1)],1)],1)])],1),e._v(" "),a("el-row",{staticClass:"btns",attrs:{gutter:20}},[a("el-button",{on:{click:e.add_update_equment}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.cancel(e.equmentform.deviceId)}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("baseDialog",{ref:"networkDialog",staticClass:"networkDialog",attrs:{title:"火警联网部件"}},[a("div",{staticClass:"topBox"},[a("el-button",{on:{click:e.Import}},[e._v("导入")]),e._v(" "),a("el-button",{staticClass:"add",on:{click:e.addNetworkcomponents}},[e._v("新增")])],1),e._v(" "),a("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",totalCount:e.networktotalCount,pageSize:5,tableThead:e.networkThead,tableData:e.networkData,currentpage:e.networkPage.current},on:{pageChange:e.network_prev_next,showdetails:e.showdetails_network,deleteInfo:e.DeleteDetector}})],1),e._v(" "),a("baseDialog",{ref:"network_detailDialog",attrs:{title:"联网部件信息"},on:{closeDialog:e.closeDialog}},[a("el-form",{ref:"network_detail",staticClass:"network_detail-form",attrs:{rules:e.networkFormrules,"label-width":"120px",model:e.networkForm}},[a("el-form-item",{attrs:{label:"部件地址：",prop:"identify"}},[a("el-input",{attrs:{placeholder:"请输入部件地址（必填）"},model:{value:e.networkForm.identify,callback:function(t){e.$set(e.networkForm,"identify",t)},expression:"networkForm.identify"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部件类型：",prop:"detectorTypeName"}},[a("el-select",{attrs:{placeholder:"请选择部件类型"},model:{value:e.networkForm.detectorTypeName,callback:function(t){e.$set(e.networkForm,"detectorTypeName",t)},expression:"networkForm.detectorTypeName"}},e._l(e.FireAlarmDetectorTypes,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("p",{staticClass:"build"},[e._v("\n            所在建筑：\n            "),a("span",[e._v(e._s(e.networkForm.fireUnitArchitectureName))])]),e._v(" "),a("el-form-item",{attrs:{label:"楼层：",prop:"fireUnitArchitectureFloorId"}},[a("el-select",{attrs:{placeholder:"请选择所在楼层"},model:{value:e.networkForm.fireUnitArchitectureFloorId,callback:function(t){e.$set(e.networkForm,"fireUnitArchitectureFloorId",t)},expression:"networkForm.fireUnitArchitectureFloorId"}},e._l(e.fireUnitArchitecturefloors,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"安装位置：",prop:"location"}},[a("el-input",{attrs:{placeholder:"请输入安装位置"},model:{value:e.networkForm.location,callback:function(t){e.$set(e.networkForm,"location",t)},expression:"networkForm.location"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.add_updatenetwork}},[e._v("提交")]),e._v(" "),a("el-button",{staticClass:"cancel",on:{click:e.network_cancel}},[e._v("取消")])],1)],1)],1),e._v(" "),a("baseDialog",{ref:"network_importDialog",staticClass:"network_importDialog",attrs:{title:"联网部件导入"}},[a("div",{staticClass:"dialog_content"},[a("p",{staticClass:"tips"},[e._v("注：导入的方式会覆盖现有的记录，如果要新增部分联网部件，请使用“新增”功能")]),e._v(" "),a("div",{staticClass:"build"},[a("p",[a("span",[e._v("所在建筑：")]),e._v(" "),a("span",[e._v(e._s(this.networkForm.fireUnitArchitectureName))])])]),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",name:"excelFile",multiple:!1,limit:1,"on-exceed":e.handleExceed,"http-request":e.uploadFile,"before-upload":e.beforeAvatarUpload,"file-list":e.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("p",[e._v("只能上传excel文件")])])],1),e._v(" "),a("div",{staticClass:"bottom"},[a("span",{on:{click:e.download}},[e._v("模板下载")])])],1)]),e._v(" "),a("baseDialog",{ref:"faultListDialog",staticClass:"threedialog",attrs:{title:"火警联网系统故障部件"}},[a("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.faultThead,tableData:e.faultData,pageSize:5,totalCount:e.faultTotalCount},on:{pageChange:e.fault_next_prevPage}})],1),e._v(" "),a("baseDialog",{ref:"fireRecord_highFrequencyDialog",staticClass:"threedialog",attrs:{title:e.alarm30_high_title}},[a("div",{staticClass:"top_tips"},[e._v("火警联网设备编号："+e._s(e.Alarm30Day_toptips_deviceSn)+" "),a("span",[e._v("所在建筑："+e._s(e.Alarm30Day_toptips_fireUnitArchitectureName))])]),e._v(" "),a("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:e.Alarm30Day_highThead,tableData:e.Alarm30Day_highData,pageSize:5,currentpage:e.Alarm30Day_highPage.current,totalCount:e.Alarm30Day_highTotal},on:{pageChange:e.next_prevPage}})],1)],1)},staticRenderFns:[]};var f=a("VU/8")(m,p,!1,function(e){a("eHZg")},null,null);t.default=f.exports},c45H:function(e,t,a){a("1alW"),e.exports=a("FeBl").Number.isInteger},eHZg:function(e,t){},fC4T:function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}}});
//# sourceMappingURL=4.f108c6060540c002381d.js.map