webpackJsonp([19],{Nc6o:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("BO1k"),n=e.n(s),i=e("Nn1j"),o=e("HR9O"),l=(localStorage.getItem("fireUnitID"),{components:{baseTable:i.a,baseDialog:o.a},data:function(){return{loading:!1,screensign:"全部",totalState:[],buttonarr:[{type:"info",text:"全部"},{type:"success",text:"正常",num:0},{type:"success",text:"故障-已解决",num:0},{type:"warning",text:"故障-未解决",num:0}],totalCount:0,tableData:[],tableThead:[{name:"提交时间",prop:"creationTime"},{name:"值班人员",prop:"dutyUserName"},{name:"状态",prop:"state"},{name:"操作"}],page:{FireUnitId:localStorage.getItem("fireUnitID"),DutyStatus:0,SkipCount:0,MaxResultCount:10},dutyInfoData:[],amr:Object,nowMoth_duty:0,arr:[]}},created:function(){this.GetDutylist(),this.GetDutyStateTotal()},mounted:function(){},methods:{screen:function(t){this.screensign=t,"全部"==t?this.page.DutyStatus=0:"正常"==t?this.page.DutyStatus=1:"故障-已解决"==t?this.page.DutyStatus=2:"故障-未解决"==t&&(this.page.DutyStatus=3),this.page.SkipCount=0,this.GetDutylist()},GetDutyStateTotal:function(){var t=this,a=localStorage.getItem("fireUnitID");this.$axios.get(this.$api.GetDutyStateTotal,{params:{fireUnitId:a}}).then(function(a){console.log("res",a),t.totalState=a.data.result,t.buttonarr[1].num=a.data.result.normalCount,t.buttonarr[2].num=a.data.result.greenFaultCount,t.buttonarr[3].num=a.data.result.redFaultCount}).catch(function(t){console.log("err",t)})},GetDutylist:function(){var t=this;this.loading=!0,this.$axios.get(this.$api.GetDutylist,{params:this.page}).then(function(a){if(console.log("打印值班记录列表",a),t.loading=!1,a.data.result.totalCount>0){var e=!0,s=!1,i=void 0;try{for(var o,l=n()(a.data.result.items);!(e=(o=l.next()).done);e=!0){var r=o.value;r.creationTime=t.deal(r.creationTime),1==r.dutyStatus?r.state="正常":2==r.dutyStatus?r.state="故障-已解决":3==r.dutyStatus&&(r.state="故障-未解决")}}catch(t){s=!0,i=t}finally{try{!e&&l.return&&l.return()}finally{if(s)throw i}}var u=a.data.result;t.totalCount=u.totalCount,t.tableData=u.items}}).catch(function(t){console.log("打印值班记录列表成功",t)})},deal:function(t){var a=t.split("T"),e=a[1].split(".");return a[0]+" "+e[0]},showdetails:function(t){this.$refs.dutyDetailsDialog.dialogVisible=!0,this.GetDutyInfo(t.dutyId)},GetDutyInfo:function(t){var a=this;this.loading=!0,this.$axios.get(this.$api.GetDutyInfo,{params:{dutyId:t}}).then(function(t){if(t.data.result.dutyPhtosPath)for(var s=0;s<t.data.result.dutyPhtosPath.length;s++)t.data.result.dutyPhtosPath[s]=""+a.$URL+t.data.result.dutyPhtosPath[s];if(t.data.result.dutyPhotosBase64)for(var n=0;n<t.data.result.dutyPhotosBase64.length;n++)t.data.result.dutyPhotosBase64[n]="data:image/jpeg;base64,"+t.data.result.dutyPhotosBase64[n];if(t.data.result.problemVoiceUrl){t.data.result.problemVoiceUrl=""+a.$URL+t.data.result.problemVoiceUrl;var i=e("/y4m");a.amr=new i,a.amr.initWithUrl(t.data.result.problemVoiceUrl)}if(t.data.result.problemPhtosPath)for(var o=0;o<t.data.result.problemPhtosPath.length;o++)t.data.result.problemPhtosPath[o]=""+a.$URL+t.data.result.problemPhtosPath[o];t.data.result.creationTime=a.deal(t.data.result.creationTime),a.dutyInfoData=t.data.result,console.log("获取值班记录详情",t),a.loading=!1}).catch(function(t){console.log("获取值班记录详情失败",t)})},playVioce:function(){this.amr.play(),this.amr.onEnded(function(){console.log("播放完毕")})},prev_next:function(t){this.page.SkipCount=(t-1)*this.page.MaxResultCount,this.GetDutylist()}}}),r={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"dutyRecord"},[s("div",{staticClass:"topStatus"},t._l(t.buttonarr,function(a){return s("el-button",{key:a.text,attrs:{round:"",plain:"",type:a.type},on:{click:function(e){return t.screen(a.text)}}},[t.screensign==a.text?s("i",{staticClass:"el-icon-check  el-icon--right"}):t._e(),t._v("\n            "+t._s(a.text)+"\n            "+t._s(a.num)+"\n        ")])}),1),t._v(" "),s("baseTable",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",tableThead:t.tableThead,tableData:t.tableData,totalCount:t.totalCount,pageSize:10,specailText:"查看值班记录"},on:{showdetails:t.showdetails,pageChange:t.prev_next}}),t._v(" "),s("baseDialog",{ref:"dutyDetailsDialog",attrs:{title:"值班记录详情"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dutyDetailsDialog",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("p",[s("span",{staticClass:"title"},[t._v("提交时间：")]),t._v("\n                "+t._s(t.dutyInfoData.creationTime)+"\n            ")]),t._v(" "),s("p",[s("span",{staticClass:"title"},[t._v("值班人员：")]),t._v("\n                "+t._s(t.dutyInfoData.dutyUserName)+"\n            ")]),t._v(" "),s("p",[s("span",{staticClass:"title"},[t._v("发现问题：")]),t._v(" "),1==t.dutyInfoData.status?s("span",{staticClass:"content"},[t._v("\n                    未发现问题状态正常\n                ")]):t._e(),t._v(" "),2==t.dutyInfoData.status?s("span",{staticClass:"content"},[t._v("\n                    发现问题（已现场解决）\n                ")]):t._e(),t._v(" "),3==t.dutyInfoData.status?s("span",{staticClass:"content"},[t._v("\n                   发现问题（未解决）\n                ")]):t._e()]),t._v(" "),s("div",{staticClass:"display"},[s("p",[s("span",{staticClass:"title"},[t._v("值班记录：")])]),t._v(" "),s("div",{staticClass:"imgBox"},[t.dutyInfoData.dutyPhtosPath?s("viewer",{staticClass:"viewer",attrs:{images:t.dutyInfoData.dutyPhtosPath}},[t._l(t.dutyInfoData.dutyPhtosPath,function(t,a){return s("img",{key:a,staticStyle:{width:"100px",height:"100px"},attrs:{src:t,fit:"cover"}})}),s("img")],2):s("p",[t._v("暂无值班记录")])],1)]),t._v(" "),s("div",{staticClass:"display"},[s("p",[s("span",{staticClass:"title"},[t._v("情况描述：")])]),t._v(" "),t.dutyInfoData.problemRemark?s("p",[t._v("\n                    "+t._s(t.dutyInfoData.problemRemark)+"\n                ")]):t._e(),t._v(" "),t.dutyInfoData.problemVoiceUrl?s("div",{staticClass:"vioceUrl",on:{click:t.playVioce}},[s("img",{attrs:{src:e("FEo8"),alt:""}}),t._v(" "),s("span",[t._v(t._s(t.dutyInfoData.voiceLength)+'"')])]):t._e()]),t._v(" "),s("div",{staticClass:"display"},[s("p",[s("span",{staticClass:"title"},[t._v("现场问题图片：")])]),t._v(" "),s("div",{staticClass:"imgBox"},[t.dutyInfoData.problemPhtosPath?s("viewer",{staticClass:"viewer",attrs:{images:t.dutyInfoData.problemPhtosPath}},[t._l(t.dutyInfoData.problemPhtosPath,function(t,a){return s("img",{key:a,staticStyle:{width:"100px",height:"100px"},attrs:{src:t,fit:"cover"}})}),s("img")],2):s("p",[t._v("暂无现场照片")])],1)])])])],1)},staticRenderFns:[]};var u=e("VU/8")(l,r,!1,function(t){e("i5jM")},null,null);a.default=u.exports},i5jM:function(t,a){}});
//# sourceMappingURL=19.89b2ab2b4f047016df4e.js.map